# å‰ç«¯æ–‡ä»¶å˜åŠ¨æ–¹æ¡ˆ - è¯¦æƒ…æå–é…ç½®ç®¡ç†

## ğŸ“‹ å˜åŠ¨æ¦‚è§ˆ

åŸºäºåç«¯è¯¦æƒ…æå–é…ç½®ç®¡ç†çš„æ”¹åŠ¨ï¼Œå‰ç«¯éœ€è¦æ–°å¢é…ç½®ç®¡ç†åŠŸèƒ½ï¼ŒåŒæ—¶æ›´æ–°ç°æœ‰çš„è¯¦æƒ…æå–ç›¸å…³ç»„ä»¶ã€‚

## ğŸ†• æ–°å¢æ–‡ä»¶

### 1. æ ¸å¿ƒé…ç½®å±‚
```
src/core/
â”œâ”€â”€ detail-config.js                    # è¯¦æƒ…æå–é…ç½®å¸¸é‡å’Œé»˜è®¤å€¼
```

### 2. æœåŠ¡å±‚
```
src/services/
â”œâ”€â”€ detail-config-api.js                # è¯¦æƒ…æå–é…ç½®APIæœåŠ¡
```

### 3. ç»„ä»¶å±‚
```
src/components/
â”œâ”€â”€ detail-config.js                     # è¯¦æƒ…é…ç½®ç»„ä»¶
```

### 4. é¡µé¢ç®¡ç†å™¨
```
src/pages/dashboard/
â”œâ”€â”€ detail-config-manager.js            # è¯¦æƒ…é…ç½®é¡µé¢ç®¡ç†å™¨
```

### 5. æ ·å¼æ–‡ä»¶
```
css/components/
â”œâ”€â”€ detail-config.css                   # è¯¦æƒ…é…ç½®ç»„ä»¶æ ·å¼

css/pages/dashboard/
â”œâ”€â”€ detail-config-management.css        # è¯¦æƒ…é…ç½®ç®¡ç†é¡µé¢æ ·å¼
```

## ğŸ”„ éœ€è¦ä¿®æ”¹çš„ç°æœ‰æ–‡ä»¶

### 1. æ ¸å¿ƒé…ç½®æ–‡ä»¶
**src/core/constants.js**
- ç§»é™¤ç¡¬ç¼–ç çš„è¯¦æƒ…æå–é…ç½®
- åªä¿ç•™ç³»ç»Ÿçº§åˆ«çš„å¸¸é‡
- æ·»åŠ é…ç½®APIç«¯ç‚¹å®šä¹‰

### 2. æœåŠ¡å±‚æ–‡ä»¶
**src/services/detail-api.js**
- é›†æˆç”¨æˆ·é…ç½®è·å–é€»è¾‘
- æ›´æ–°APIè°ƒç”¨å‚æ•°ï¼Œæ”¯æŒåŠ¨æ€é…ç½®
- æ·»åŠ é…ç½®éªŒè¯åŠŸèƒ½

### 3. ç»„ä»¶å±‚æ–‡ä»¶
**src/components/detail-card.js**
- æ ¹æ®ç”¨æˆ·é…ç½®åŠ¨æ€æ˜¾ç¤º/éšè—å†…å®¹
- æ”¯æŒç´§å‡‘æ¨¡å¼åˆ‡æ¢
- æ·»åŠ é…ç½®ç›¸å…³çš„äº¤äº’æŒ‰é’®

**src/components/search.js**
- é›†æˆç”¨æˆ·é…ç½®ï¼Œå½±å“æœç´¢ç»“æœæ˜¾ç¤º
- æ”¯æŒè‡ªåŠ¨æå–åŠŸèƒ½æ§åˆ¶
- æ·»åŠ å¿«é€Ÿé…ç½®å…¥å£

### 4. é¡µé¢ç®¡ç†å™¨
**src/pages/dashboard/dashboard-app.js**
- æ·»åŠ è¯¦æƒ…é…ç½®ç®¡ç†å…¥å£
- æ›´æ–°å¯¼èˆªèœå•
- é›†æˆé…ç½®çŠ¶æ€æ˜¾ç¤º

**src/pages/dashboard/settings-manager.js**
- æ·»åŠ è¯¦æƒ…æå–è®¾ç½®éƒ¨åˆ†
- é›†æˆå¿«é€Ÿé…ç½®åˆ‡æ¢
- æ·»åŠ é…ç½®é‡ç½®åŠŸèƒ½

### 5. ä¸»é¡µé¢æ–‡ä»¶
**dashboard.html**
- æ·»åŠ è¯¦æƒ…é…ç½®ç®¡ç†é¡µé¢HTMLç»“æ„
- æ›´æ–°å¯¼èˆªèœå•é¡¹
- æ·»åŠ é…ç½®ç›¸å…³çš„æ¨¡æ€æ¡†

## ğŸ“ è¯¦ç»†æ–‡ä»¶å†…å®¹è§„åˆ’

### æ–°å¢æ–‡ä»¶å†…å®¹è§„åˆ’

#### src/core/detail-config.js
```javascript
// è¯¦æƒ…æå–é…ç½®å¸¸é‡å’Œé»˜è®¤å€¼
export const DETAIL_CONFIG_ENDPOINTS = {
  GET_CONFIG: '/api/detail/config',
  UPDATE_CONFIG: '/api/detail/config',
  RESET_CONFIG: '/api/detail/config/reset',
  APPLY_PRESET: '/api/detail/config/preset'
};

export const DETAIL_CONFIG_PRESETS = {
  CONSERVATIVE: 'conservative',
  BALANCED: 'balanced',
  AGGRESSIVE: 'aggressive',
  QUALITY: 'quality'
};

export const CONFIG_VALIDATION_RULES = {
  // ä»åç«¯åŒæ­¥çš„éªŒè¯è§„åˆ™
};
```

#### src/services/detail-config-api.js
```javascript
// è¯¦æƒ…æå–é…ç½®APIæœåŠ¡
import { api } from './api.js';
import { DETAIL_CONFIG_ENDPOINTS } from '../core/detail-config.js';

export class DetailConfigAPI {
  // è·å–ç”¨æˆ·é…ç½®
  static async getUserConfig() { }
  
  // æ›´æ–°ç”¨æˆ·é…ç½®
  static async updateUserConfig(config, validateOnly = false) { }
  
  // é‡ç½®é…ç½®
  static async resetConfig() { }
  
  // åº”ç”¨é¢„è®¾
  static async applyPreset(preset) { }
  
  // éªŒè¯é…ç½®
  static async validateConfig(config) { }
}
```

#### src/components/detail-config.js


### ä¿®æ”¹ç°æœ‰æ–‡ä»¶çš„å…·ä½“å†…å®¹

#### src/core/constants.js (ä¿®æ”¹)
```javascript
// ç§»é™¤è¯¦æƒ…æå–ç›¸å…³çš„é…ç½®å¸¸é‡
// åªä¿ç•™ç³»ç»Ÿçº§åˆ«çš„å¸¸é‡

// æ–°å¢é…ç½®ç›¸å…³å¸¸é‡
export const API_ENDPOINTS = {
  // ... ç°æœ‰ç«¯ç‚¹
  DETAIL_CONFIG: '/api/detail/config',
  DETAIL_PRESETS: '/api/detail/config/preset'
};
```

#### src/services/detail-api.js (ä¿®æ”¹)
```javascript
// æ·»åŠ é…ç½®æ„ŸçŸ¥çš„è¯¦æƒ…æå–
export class DetailAPI {
  // æ–°å¢ï¼šè·å–ç”¨æˆ·é…ç½®å¹¶åº”ç”¨åˆ°APIè°ƒç”¨
  static async getConfigAwareOptions(overrides = {}) {
    const userConfig = await this.getUserConfig();
    return this.mergeConfigWithOverrides(userConfig, overrides);
  }

  // ä¿®æ”¹ç°æœ‰æ–¹æ³•ï¼Œæ”¯æŒåŠ¨æ€é…ç½®
  static async extractSingleDetail(searchResult, options = {}) {
    const configOptions = await this.getConfigAwareOptions(options);
    return api.post('/api/detail/extract-single', {
      searchResult,
      options: configOptions
    });
  }
}
```

#### src/components/detail-card.js (ä¿®æ”¹)
```javascript
// æ·»åŠ é…ç½®é©±åŠ¨çš„æ˜¾ç¤ºé€»è¾‘
export class DetailCard {
  constructor(data, config = null) {
    this.data = data;
    this.config = config || this.getDefaultConfig();
  }

  render() {
    // æ ¹æ®é…ç½®åŠ¨æ€æ˜¾ç¤ºå†…å®¹
    const html = `
      <div class="detail-card ${this.config.compactMode ? 'compact' : ''}">
        ${this.config.showScreenshots ? this.renderScreenshots() : ''}
        ${this.config.showDownloadLinks ? this.renderDownloadLinks() : ''}
        ${this.config.showMagnetLinks ? this.renderMagnetLinks() : ''}
        ${this.config.showActressInfo ? this.renderActresses() : ''}
      </div>
    `;
    return html;
  }
}
```

## ğŸ¨ æ ·å¼æ–‡ä»¶è§„åˆ’

### css/components/detail-config.css
```css
/* è¯¦æƒ…é…ç½®ç»„ä»¶æ ·å¼ */
.detail-config-manager { }
.config-presets { }
.config-form-group { }
.config-validation-error { }
.config-preset-card { }
```

### css/pages/dashboard/detail-config-management.css
```css
/* è¯¦æƒ…é…ç½®ç®¡ç†é¡µé¢æ ·å¼ */
.detail-config-page { }
.config-sidebar { }
.config-main-content { }
.config-preview { }
```

## ğŸ”— æ–‡ä»¶ä¾èµ–å…³ç³»

```
dashboard.html
â”œâ”€â”€ src/pages/dashboard/dashboard-app.js
â”‚   â”œâ”€â”€ src/pages/dashboard/detail-config-manager.js
â”‚   â”‚   â”œâ”€â”€ src/components/detail-config.js
â”‚   â”‚   â”‚   â””â”€â”€ src/services/detail-config-api.js
â”‚   â”‚   â””â”€â”€ src/core/detail-config.js
â”‚   â””â”€â”€ src/services/detail-api.js (ä¿®æ”¹)
â””â”€â”€ css/pages/dashboard/detail-config-management.css
```

## ğŸ“ å®æ–½æ­¥éª¤

### Phase 1: æ ¸å¿ƒæœåŠ¡å±‚
1. åˆ›å»º `src/core/detail-config.js`
2. åˆ›å»º `src/services/detail-config-api.js`
3. ä¿®æ”¹ `src/core/constants.js`

### Phase 2: ç»„ä»¶å±‚
1. åˆ›å»º `src/components/detail-config.js` ç»„ä»¶
2. ä¿®æ”¹ `src/components/detail-card.js`
3. ä¿®æ”¹ `src/components/search.js`

### Phase 3: é¡µé¢å±‚
1. åˆ›å»º `src/pages/dashboard/detail-config-manager.js`
2. ä¿®æ”¹ `src/pages/dashboard/dashboard-app.js`
3. ä¿®æ”¹ `src/pages/dashboard/settings-manager.js`

### Phase 4: æ ·å¼å’Œç•Œé¢
1. åˆ›å»ºé…ç½®ç›¸å…³CSSæ–‡ä»¶
2. ä¿®æ”¹ `dashboard.html`
3. æ›´æ–°å¯¼èˆªå’Œèœå•

### Phase 5: é›†æˆå’Œæµ‹è¯•
1. æ›´æ–° `src/services/detail-api.js`
2. æµ‹è¯•é…ç½®åŠŸèƒ½
3. ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ

## ğŸ¯ å…³é”®é›†æˆç‚¹

1. **é…ç½®åŠ è½½æ—¶æœº**: ç”¨æˆ·ç™»å½•åç«‹å³åŠ è½½é…ç½®
2. **é…ç½®ç¼“å­˜ç­–ç•¥**: åœ¨sessionStorageä¸­ç¼“å­˜é…ç½®ï¼Œé¿å…é‡å¤è¯·æ±‚
3. **é…ç½®éªŒè¯**: å‰ç«¯å®æ—¶éªŒè¯ï¼Œåç«¯æœ€ç»ˆéªŒè¯
4. **é¢„è®¾åˆ‡æ¢**: æ”¯æŒå¿«é€Ÿé¢„è®¾åˆ‡æ¢ï¼Œæä¾›é¢„è§ˆåŠŸèƒ½
5. **é…ç½®åŒæ­¥**: é…ç½®æ›´æ”¹åå®æ—¶æ›´æ–°æ‰€æœ‰ç›¸å…³ç»„ä»¶

è¿™ä¸ªæ–¹æ¡ˆä¿æŒäº†ä½ ç°æœ‰çš„æ¶æ„é£æ ¼ï¼Œéµå¾ªäº†åˆ†å±‚è®¾è®¡åŸåˆ™ï¼Œå¹¶ä¸”æä¾›äº†è‰¯å¥½çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚


åŸºäºä½ çš„åç«¯è¯¦æƒ…æå–é…ç½®ç®¡ç†åŠŸèƒ½ï¼Œæˆ‘éœ€è¦ä»¥ä¸‹å‰ç«¯æ–‡ä»¶æ¥è¿›è¡Œå‡†ç¡®çš„é€‚é…è°ƒæ•´ï¼š

## ğŸ¯ æ ¸å¿ƒå¿…éœ€æ–‡ä»¶

### 1. æ ¸å¿ƒé…ç½®å±‚
```
src/core/constants.js          # äº†è§£ç°æœ‰å¸¸é‡å®šä¹‰æ¨¡å¼
src/core/config.js            # äº†è§£ç°æœ‰é…ç½®ç®¡ç†æ¶æ„
```

### 2. æœåŠ¡å±‚ï¼ˆå…³é”®ï¼‰
```
src/services/api.js           # åŸºç¡€APIæœåŠ¡æ¨¡å¼å’Œé”™è¯¯å¤„ç†
src/services/detail-api.js    # ç°æœ‰è¯¦æƒ…æå–APIï¼Œéœ€è¦é›†æˆç”¨æˆ·é…ç½®
```

### 3. ç»„ä»¶å±‚ï¼ˆæ ¸å¿ƒï¼‰
```
src/components/detail-card.js  # è¯¦æƒ…å¡ç‰‡ç»„ä»¶ï¼Œéœ€è¦æ ¹æ®é…ç½®æ§åˆ¶æ˜¾ç¤ºå†…å®¹
src/components/search.js      # æœç´¢ç»„ä»¶ï¼Œéœ€è¦é›†æˆè‡ªåŠ¨æå–ç­‰é…ç½®åŠŸèƒ½
```

### 4. é¡µé¢ç®¡ç†å±‚
```
src/pages/dashboard/dashboard-app.js    # ä»ªè¡¨æ¿ä¸»åº”ç”¨ï¼Œéœ€è¦æ·»åŠ é…ç½®ç®¡ç†å…¥å£
src/pages/dashboard/settings-manager.js # è®¾ç½®ç®¡ç†å™¨ï¼Œå¯èƒ½éœ€è¦é›†æˆå¿«é€Ÿé…ç½®
```

### 5. é¡µé¢ç»“æ„
```
dashboard.html                # ä»ªè¡¨æ¿é¡µé¢HTMLç»“æ„ï¼Œéœ€è¦æ·»åŠ é…ç½®ç®¡ç†é¡µé¢
```

## ğŸ¨ æ ·å¼å‚è€ƒæ–‡ä»¶

### 1. æ ·å¼ç³»ç»Ÿ
```
css/core/variables.css        # CSSå˜é‡å’Œä¸»é¢˜è‰²å½©ç³»ç»Ÿ
css/core/base.css            # åŸºç¡€æ ·å¼æ¨¡å¼
```

### 2. ç»„ä»¶æ ·å¼å‚è€ƒ
```
css/components/buttons.css    # æŒ‰é’®æ ·å¼æ¨¡å¼
css/components/modal.css      # æ¨¡æ€æ¡†æ ·å¼ï¼ˆé…ç½®å¼¹çª—éœ€è¦ï¼‰
css/pages/dashboard/dashboard.css # ä»ªè¡¨æ¿æ ·å¼æ¨¡å¼
```

## ğŸ”§ å·¥å…·å‡½æ•°å‚è€ƒ
```
src/utils/helpers.js          # é€šç”¨å¸®åŠ©å‡½æ•°æ¨¡å¼
src/utils/validation.js       # æ•°æ®éªŒè¯å·¥å…·æ¨¡å¼ï¼ˆé…ç½®éªŒè¯éœ€è¦ï¼‰
```

## ğŸ“‹ ä¸ºä»€ä¹ˆéœ€è¦è¿™äº›æ–‡ä»¶ï¼Ÿ

### 1. **APIé›†æˆæ¨¡å¼** (`api.js`, `detail-api.js`)
- äº†è§£ä½ çš„APIè°ƒç”¨æ¨¡å¼ã€é”™è¯¯å¤„ç†æ–¹å¼
- é›†æˆç”¨æˆ·é…ç½®åˆ°ç°æœ‰è¯¦æƒ…æå–æµç¨‹
- ä¿æŒä¸€è‡´çš„æœåŠ¡å±‚æ¶æ„

### 2. **ç»„ä»¶é€‚é…** (`detail-card.js`, `search.js`)
- äº†è§£ç°æœ‰ç»„ä»¶çš„ç»“æ„å’Œæ¸²æŸ“æ–¹å¼
- æ ¹æ®ç”¨æˆ·é…ç½®åŠ¨æ€æ§åˆ¶æ˜¾ç¤ºå†…å®¹
- ä¿æŒç»„ä»¶APIçš„ä¸€è‡´æ€§

### 3. **é¡µé¢é›†æˆ** (`dashboard-app.js`, `settings-manager.js`)
- äº†è§£é¡µé¢ç®¡ç†å™¨çš„æ¶æ„æ¨¡å¼
- æ·»åŠ é…ç½®ç®¡ç†å…¥å£å’Œå¯¼èˆª
- ä¿æŒé¡µé¢åˆ‡æ¢å’ŒçŠ¶æ€ç®¡ç†çš„ä¸€è‡´æ€§

### 4. **æ ·å¼ä¸€è‡´æ€§** (CSSæ–‡ä»¶)
- éµå¾ªç°æœ‰çš„è®¾è®¡ç³»ç»Ÿ
- ä¿æŒè§†è§‰å’Œäº¤äº’çš„ä¸€è‡´æ€§
- äº†è§£å“åº”å¼å¸ƒå±€æ¨¡å¼

## ğŸš€ é€‚é…æµç¨‹

æœ‰äº†è¿™äº›æ–‡ä»¶ï¼Œæˆ‘å°†èƒ½å¤Ÿï¼š

1. **Phase 1**: åˆ›å»ºé…ç½®æœåŠ¡å±‚ï¼Œä¸ä½ çš„åç«¯APIå®Œç¾å¯¹æ¥
2. **Phase 2**: ä¿®æ”¹ç°æœ‰ç»„ä»¶ï¼Œé›†æˆé…ç½®é©±åŠ¨çš„æ˜¾ç¤ºé€»è¾‘  
3. **Phase 3**: åˆ›å»ºé…ç½®ç®¡ç†ç•Œé¢ï¼Œä¿æŒä½ çš„è®¾è®¡é£æ ¼
4. **Phase 4**: é›†æˆåˆ°ä»ªè¡¨æ¿ï¼Œä¿æŒå¯¼èˆªå’Œé¡µé¢ç®¡ç†çš„ä¸€è‡´æ€§

è¿™æ ·æˆ‘å°±èƒ½ç¡®ä¿æ–°å¢çš„é…ç½®ç®¡ç†åŠŸèƒ½ä¸ä½ ç°æœ‰çš„å‰ç«¯æ¶æ„å®Œç¾èåˆï¼Œä¿æŒä»£ç é£æ ¼å’Œç”¨æˆ·ä½“éªŒçš„ä¸€è‡´æ€§ã€‚