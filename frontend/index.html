<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>磁力快搜 - 专业版</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
    
    <!-- Cloudflare Pages环境变量配置 -->
    <script>
        // 从环境变量获取配置
        window.APP_CONFIG = {
            API_BASE_URL: __ENV_API_BASE_URL__ || 'https://default-worker.your-domain.workers.dev',
            ALLOW_REGISTRATION: __ENV_ALLOW_REGISTRATION__ === 'true',
            DEFAULT_THEME: __ENV_DEFAULT_THEME__ || 'light',
            MAX_FAVORITES: parseInt(__ENV_MAX_FAVORITES__ || '500'),
            MAX_HISTORY: parseInt(__ENV_MAX_HISTORY__ || '100'),
            SEARCH_DEBOUNCE: parseInt(__ENV_SEARCH_DEBOUNCE__ || '300'),
            JWT_EXPIRY_DAYS: parseInt(__ENV_JWT_EXPIRY_DAYS__ || '30'),
            ENABLE_ANALYTICS: __ENV_ENABLE_ANALYTICS__ === 'true',
            VERSION: __ENV_VERSION__ || '1.0.0',
            ENVIRONMENT: __ENV_ENVIRONMENT__ || 'production',
            BUILD_DATE: __ENV_BUILD_DATE__ || '',
            COMMIT_HASH: __ENV_COMMIT_HASH__ || '',
        };
    </script>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <img src="/images/logo.png" alt="Logo" class="logo">
                <span class="brand-text">磁力快搜</span>
                <span class="env-badge">${__ENV_ENVIRONMENT__ || 'production'}</span>
            </div>
            <div class="nav-links">
                <a href="#" class="nav-link active">首页</a>
                <a href="#" class="nav-link">收藏夹</a>
                <a href="#" class="nav-link">历史记录</a>
                <div id="userPanel" class="user-panel hidden">
                    <img id="userAvatar" src="/images/user-avatar.png" alt="用户头像" class="avatar">
                    <div class="dropdown-menu">
                        <a href="#" class="dropdown-item">个人中心</a>
                        <a href="#" class="dropdown-item" id="logoutBtn">退出登录</a>
                    </div>
                </div>
                <div id="authButtons" class="auth-buttons">
                    <button class="btn btn-outline" id="loginBtn">登录</button>
                    <button class="btn btn-primary" id="registerBtn">注册</button>
                </div>
            </div>
            <div class="theme-switch">
                <input type="checkbox" id="themeToggle" class="switch">
                <label for="themeToggle"></label>
            </div>
        </div>
    </nav>

    <!-- 主要内容区域 -->
    <main class="main-content">
        <!-- 搜索框 -->
        <div class="search-box">
            <input type="text" id="searchInput" class="search-input" 
                   placeholder="请输入番号或关键词" autocomplete="off">
            <button id="searchBtn" class="search-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14Z" fill="white"/>
                </svg>
                搜索
            </button>
        </div>
        
        <!-- 搜索历史 -->
        <div id="searchHistory" class="history-container">
            <div class="history-header">
                <span>最近搜索</span>
                <button id="clearHistory" class="clear-btn">清空</button>
            </div>
            <ul id="historyList" class="history-list"></ul>
        </div>
        
        <!-- 收藏夹 -->
        <div id="favoritesContainer" class="favorites-container hidden">
            <div class="favorites-header">
                <span>我的收藏</span>
            </div>
            <div id="favoritesList" class="favorites-list"></div>
        </div>
        
        <!-- 结果区域 -->
        <div id="searchResults" class="results-container"></div>
        
        <!-- 模态框 - 登录和注册 -->
        <div id="authModal" class="modal">
            <div class="modal-content">
                <span class="close-btn">&times;</span>
                <div id="loginForm" class="auth-form">
                    <h3>登录</h3>
                    <div class="form-group">
                        <label for="loginUsername">用户名/邮箱</label>
                        <input type="text" id="loginUsername" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">密码</label>
                        <input type="password" id="loginPassword" class="form-input">
                    </div>
                    <div class="form-footer">
                        <button id="loginSubmit" class="btn btn-primary">登录</button>
                    </div>
                </div>
                <div id="registerForm" class="auth-form hidden">
                    <h3>注册</h3>
                    <div class="form-group">
                        <label for="registerUsername">用户名</label>
                        <input type="text" id="registerUsername" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="registerEmail">邮箱</label>
                        <input type="email" id="registerEmail" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">密码</label>
                        <input type="password" id="registerPassword" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="registerConfirmPassword">确认密码</label>
                        <input type="password" id="registerConfirmPassword" class="form-input">
                    </div>
                    <div class="form-footer">
                        <button id="registerSubmit" class="btn btn-primary">注册</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 通知 -->
        <div id="toastContainer" class="toast-container"></div>
    </main>

    <!-- 脚本文件 -->
    <script src="/js/utils.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/main.js"></script>
    
    <!-- 初始化应用程序 -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const app = new MagnetSearchApp();
            app.init();
        });
    </script>
</body>
</html>