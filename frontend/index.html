<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">ç£åŠ›å¿«æœ - ä¸“ä¸šç‰ˆ</title>
    <meta name="description" content="ä¸“ä¸šçš„ç£åŠ›æœç´¢å·¥å…·ï¼Œæ”¯æŒäº‘ç«¯åŒæ­¥ï¼Œæ™ºèƒ½æœç´¢ï¼Œæè‡´ä½“éªŒ">
    <meta name="keywords" content="ç£åŠ›æœç´¢,BTä¸‹è½½,èµ„æºæœç´¢,äº‘ç«¯åŒæ­¥">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* ç°ä»£åŒ–CSSå˜é‡ */
        :root {
            --primary: #6366f1;
            --primary-dark: #4338ca;
            --primary-light: #e0e7ff;
            --secondary: #f3f4f6;
            --accent: #10b981;
            --accent-hover: #059669;
            --warning: #f59e0b;
            --danger: #ef4444;
            --success: #22c55e;
            
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --bg-card: rgba(255, 255, 255, 0.8);
            --bg-glass: rgba(255, 255, 255, 0.1);
            
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            
            --border: #e2e8f0;
            --border-light: #f1f5f9;
            
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-accent: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: all 0.15s ease-out;
            --transition-bounce: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        /* æ·±è‰²ä¸»é¢˜ */
        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --bg-card: rgba(30, 41, 59, 0.8);
            --bg-glass: rgba(255, 255, 255, 0.05);
            
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            
            --border: #374151;
            --border-light: #4b5563;
        }

        /* å…¨å±€æ ·å¼é‡ç½® */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--text-primary);
            line-height: 1.6;
            transition: var(--transition);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ç»ç’ƒæ€èƒŒæ™¯ */
        .glass-bg {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            background: var(--bg-glass);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* å¯¼èˆªæ  */
        .navbar {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: var(--transition);
        }

        .navbar.scrolled {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: var(--shadow-md);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
            height: 70px;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
            transition: var(--transition);
        }

        .nav-brand:hover {
            transform: scale(1.05);
        }

        .logo {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .nav-menu {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .theme-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            font-size: 1.25rem;
            cursor: pointer;
            padding: 0.75rem;
            border-radius: 50%;
            transition: var(--transition-bounce);
            color: var(--text-primary);
        }

        .theme-btn:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.1) rotate(15deg);
        }

        .login-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius-lg);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            position: relative;
        }

        .username {
            font-weight: 600;
            color: var(--text-primary);
        }

        .dropdown {
            position: relative;
        }

        .dropdown-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            color: var(--text-secondary);
            border-radius: var(--radius-sm);
            transition: var(--transition);
        }

        .dropdown-btn:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .dropdown-content {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            min-width: 180px;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: var(--transition);
        }

        .dropdown:hover .dropdown-content {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-content a {
            display: block;
            padding: 0.75rem 1rem;
            color: var(--text-primary);
            text-decoration: none;
            transition: var(--transition);
            border-radius: var(--radius-md);
            margin: 0.25rem;
        }

        .dropdown-content a:hover {
            background: var(--primary-light);
            color: var(--primary);
            transform: translateX(4px);
        }

        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 3rem 2rem;
            position: relative;
        }

        /* HeroåŒºåŸŸ */
        .hero {
            text-align: center;
            margin-bottom: 4rem;
            position: relative;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
        }

        .hero-title {
            font-size: clamp(2.5rem, 8vw, 4rem);
            font-weight: 800;
            background: linear-gradient(135deg, #fff 0%, rgba(255,255,255,0.8) 100%);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1.5rem;
            position: relative;
            z-index: 1;
        }

        .hero-subtitle {
            font-size: 1.25rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 3rem;
            font-weight: 400;
            position: relative;
            z-index: 1;
        }

        /* æœç´¢å®¹å™¨ */
        .search-container {
            max-width: 700px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .search-box {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            position: relative;
        }

        .search-input {
            flex: 1;
            padding: 1rem 1.25rem;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-xl);
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            color: var(--text-primary);
            font-size: 1.1rem;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1), var(--shadow-md);
            transform: translateY(-1px);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .search-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: var(--radius-xl);
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: var(--transition-bounce);
            box-shadow: var(--shadow-md);
            font-size: 1rem;
        }

        .search-btn:hover:not(:disabled) {
            transform: translateY(-2px) scale(1.02);
            box-shadow: var(--shadow-lg);
        }

        .search-btn:active {
            transform: translateY(0) scale(0.98);
        }

        .search-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .search-options {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-lg);
            transition: var(--transition);
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .checkbox-label:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        .checkbox-label input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        /* æœç´¢å»ºè®® */
        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-top: none;
            border-radius: 0 0 var(--radius-xl) var(--radius-xl);
            box-shadow: var(--shadow-lg);
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: var(--transition);
        }

        .search-suggestions.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .suggestion-item {
            display: flex;
            align-items: center;
            padding: 1rem 1.25rem;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-item:hover {
            background: var(--primary-light);
            transform: translateX(4px);
        }

        .suggestion-icon {
            margin-right: 0.75rem;
            font-size: 1rem;
            opacity: 0.7;
        }

        .suggestion-text {
            color: var(--text-primary);
            font-weight: 500;
        }

        /* é€šç”¨sectionæ ·å¼ */
        section {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-xl);
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
        }

        section:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .section-header h2 {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius-lg);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition-bounce);
            border: none;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: var(--shadow-sm);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-success {
            background: var(--gradient-accent);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        /* æœç´¢å†å² */
        .history-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .history-item {
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 0.75rem 1.25rem;
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: var(--transition-bounce);
            border: 1px solid var(--border);
            font-weight: 500;
        }

        .history-item:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px) scale(1.05);
            box-shadow: var(--shadow-md);
        }

        /* æœç´¢ç»“æœ */
        .search-info {
            text-align: center;
            margin-bottom: 2rem;
            padding: 1rem;
            background: var(--primary-light);
            border-radius: var(--radius-lg);
            color: var(--primary-dark);
            font-weight: 600;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .result-item {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            padding: 1.5rem;
            text-align: center;
            border: 1px solid var(--border);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .result-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        .result-item:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: var(--shadow-lg);
        }

        .result-image {
            width: 100%;
            height: 140px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 0.9rem;
            position: relative;
            overflow: hidden;
        }

        .result-image::before {
            content: 'ğŸ¬';
            font-size: 3rem;
            opacity: 0.3;
        }

        .result-title {
            font-weight: 700;
            margin-bottom: 0.75rem;
            color: var(--primary);
            font-size: 1.1rem;
            line-height: 1.4;
        }

        .result-subtitle {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 1.25rem;
            line-height: 1.5;
        }

        .result-actions {
            display: flex;
            gap: 0.75rem;
        }

        .result-actions .btn {
            flex: 1;
            padding: 0.75rem;
            font-size: 0.85rem;
            border-radius: var(--radius-lg);
        }

        .visit-btn {
            background: var(--gradient-primary);
            color: white;
        }

        .favorite-btn {
            background: var(--warning);
            color: white;
        }

        .favorite-btn.favorited {
            background: var(--success);
        }

        /* æ”¶è—å¤¹ */
        .favorites-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
        }

        .favorite-item {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            padding: 1.5rem;
            border: 1px solid var(--border);
            transition: var(--transition);
            position: relative;
            box-shadow: var(--shadow-sm);
        }

        .favorite-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .favorite-title {
            font-weight: 700;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
            font-size: 1.1rem;
        }

        .favorite-url {
            font-size: 0.85rem;
            color: var(--text-secondary);
            word-break: break-all;
            margin-bottom: 1.25rem;
            padding: 0.75rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            border-left: 3px solid var(--primary);
        }

        .favorite-actions {
            display: flex;
            gap: 0.75rem;
        }

        .favorite-actions .btn {
            flex: 1;
            padding: 0.5rem;
            font-size: 0.85rem;
        }

        /* ç«™ç‚¹å¯¼èˆª */
        .sites-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }

        .site-category {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            padding: 1.5rem;
            border: 1px solid var(--border);
            transition: var(--transition);
        }

        .site-category:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .site-category h3 {
            margin-bottom: 1.25rem;
            color: var(--text-primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 0.75rem;
            font-size: 1.25rem;
            font-weight: 700;
        }

        .site-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .site-item {
            display: block;
            padding: 1.25rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            text-decoration: none;
            color: var(--text-primary);
            border: 1px solid var(--border);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .site-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            width: 4px;
            background: var(--gradient-primary);
            transform: scaleY(0);
            transition: var(--transition);
        }

        .site-item:hover {
            transform: translateY(-2px) translateX(4px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary);
        }

        .site-item:hover::before {
            transform: scaleY(1);
        }

        .site-info strong {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--primary);
            font-size: 1.1rem;
            font-weight: 700;
        }

        .site-info span {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            padding: 2.5rem;
            border-radius: var(--radius-xl);
            width: 90%;
            max-width: 450px;
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: slideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .modal-content h2 {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--text-primary);
            font-size: 1.75rem;
            font-weight: 700;
        }

        .close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-muted);
            transition: var(--transition);
            padding: 0.5rem;
            border-radius: 50%;
            background: var(--bg-secondary);
        }

        .close:hover {
            color: var(--danger);
            background: rgba(239, 68, 68, 0.1);
            transform: scale(1.1);
        }

        .form-group {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .form-group input {
            width: 100%;
            padding: 1rem 1.25rem;
            border: 2px solid var(--border);
            border-radius: var(--radius-lg);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .form-group input::placeholder {
            color: var(--text-muted);
        }

        .submit-btn {
            width: 100%;
            padding: 1rem;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: var(--radius-lg);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 700;
            transition: var(--transition-bounce);
            box-shadow: var(--shadow-md);
        }

        .submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .submit-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .form-links {
            text-align: center;
            margin-top: 1.5rem;
        }

        .form-links a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
        }

        .form-links a:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }

        /* Toasté€šçŸ¥ */
        .toast {
            position: fixed;
            top: 30px;
            right: 30px;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            color: var(--text-primary);
            padding: 1.25rem 1.75rem;
            border-radius: var(--radius-lg);
            z-index: 2001;
            transform: translateX(400px);
            transition: var(--transition-bounce);
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--border);
            min-width: 300px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.error {
            background: var(--danger);
            color: white;
        }

        .toast.success {
            background: var(--success);
            color: white;
        }

        .toast.warning {
            background: var(--warning);
            color: white;
        }

        /* LoadingåŠ¨ç”» */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2002;
            flex-direction: column;
            gap: 1.5rem;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .loading-text {
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
        }

        /* è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .connection-status {
            position: fixed;
            top: 90px;
            right: 30px;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1.25rem;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            font-size: 0.9rem;
            z-index: 1500;
            box-shadow: var(--shadow-md);
            font-weight: 600;
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-indicator.checking {
            background: var(--warning);
        }

        .status-indicator.connected {
            background: var(--success);
        }

        .status-indicator.warning {
            background: var(--warning);
        }

        .status-indicator.error {
            background: var(--danger);
        }

        /* ç©ºçŠ¶æ€ */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
        }

        .empty-state .emoji {
            font-size: 4rem;
            margin-bottom: 1rem;
            display: block;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
            font-weight: 700;
        }

        .empty-state p {
            font-size: 1.1rem;
            line-height: 1.6;
            max-width: 400px;
            margin: 0 auto;
        }

        /* å¿«é€Ÿæç¤º */
        .quick-tips {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%);
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .tips-content h3 {
            color: var(--primary);
            margin-bottom: 1rem;
            font-size: 1.25rem;
            font-weight: 700;
        }

        .tips-content ul {
            list-style: none;
            padding: 0;
        }

        .tips-content li {
            padding: 0.5rem 0;
            position: relative;
            padding-left: 2rem;
            color: var(--text-primary);
            font-weight: 500;
        }

        .tips-content li::before {
            content: 'âœ¨';
            position: absolute;
            left: 0;
            top: 0.5rem;
        }

        /* åŠ¨ç”» */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { 
                transform: translate(-50%, -60%); 
                opacity: 0; 
                scale: 0.9;
            }
            to { 
                transform: translate(-50%, -50%); 
                opacity: 1; 
                scale: 1;
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        @keyframes slideInLeft {
            from {
                transform: translateX(-100px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideInUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .nav-container {
                padding: 0 1rem;
            }
            
            .nav-brand .brand-text {
                font-size: 1.25rem;
            }
            
            .main-content {
                padding: 2rem 1rem;
            }
            
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-subtitle {
                font-size: 1.1rem;
            }
            
            .search-box {
                flex-direction: column;
                gap: 1rem;
            }
            
            .search-btn {
                justify-content: center;
                padding: 1rem;
            }
            
            .search-options {
                flex-direction: column;
                gap: 1rem;
                align-items: center;
            }
            
            .results-grid, 
            .favorites-grid {
                grid-template-columns: 1fr;
            }
            
            .sites-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95%;
                padding: 2rem;
                margin: 1rem;
            }
            
            .section-header {
                flex-direction: column;
                align-items: stretch;
                text-align: center;
            }
            
            .section-header h2 {
                justify-content: center;
            }
            
            .section-actions {
                justify-content: center;
            }
            
            .toast {
                top: 20px;
                right: 20px;
                left: 20px;
                transform: translateY(-100px);
                min-width: auto;
            }
            
            .toast.show {
                transform: translateY(0);
            }
            
            .connection-status {
                top: 80px;
                right: 20px;
                left: 20px;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .hero-title {
                font-size: 2rem;
            }
            
            .hero-subtitle {
                font-size: 1rem;
            }
            
            .nav-container {
                height: 60px;
            }
            
            .nav-menu {
                gap: 1rem;
            }
            
            .section {
                padding: 1.5rem;
            }
            
            .result-actions,
            .favorite-actions {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .history-list {
                justify-content: center;
            }
            
            .site-item {
                padding: 1rem;
            }
        }

        /* é«˜å¯¹æ¯”åº¦æ¨¡å¼æ”¯æŒ */
        @media (prefers-contrast: high) {
            :root {
                --border: #000000;
                --text-secondary: #000000;
            }
            
            [data-theme="dark"] {
                --border: #ffffff;
                --text-secondary: #ffffff;
            }
        }

        /* å‡å°‘åŠ¨ç”»æ¨¡å¼æ”¯æŒ */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* æ‰“å°æ ·å¼ */
        @media print {
            .navbar,
            .search-container,
            .modal,
            .toast,
            .loading,
            .connection-status {
                display: none !important;
            }
            
            body {
                background: white !important;
                color: black !important;
            }
            
            section {
                background: white !important;
                border: 1px solid black !important;
                box-shadow: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar" id="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <div class="logo">M</div>
                <span class="brand-text" id="brand-text">ç£åŠ›å¿«æœ</span>
            </div>
            <div class="nav-menu">
                <button id="themeToggle" class="theme-btn" title="åˆ‡æ¢ä¸»é¢˜" aria-label="åˆ‡æ¢ä¸»é¢˜">
                    <span id="themeIcon">ğŸŒ™</span>
                </button>
                <div id="userMenu" class="user-menu">
                    <button id="loginBtn" class="login-btn">ç™»å½•</button>
                    <div id="userInfo" class="user-info" style="display:none;">
                        <span id="username" class="username"></span>
                        <div class="dropdown">
                            <button class="dropdown-btn" title="ç”¨æˆ·èœå•" aria-label="ç”¨æˆ·èœå•">â–¼</button>
                            <div class="dropdown-content" role="menu">
                                <a href="#" onclick="navigateToDashboard(); return false;" role="menuitem">ğŸ  ä¸ªäººä¸­å¿ƒ</a>
                                <a href="#" id="logoutBtn" role="menuitem">ğŸšª é€€å‡ºç™»å½•</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <main class="main-content" style="display:none;">
        <!-- HeroåŒºåŸŸ -->
        <section class="hero">
            <h1 class="hero-title" id="hero-title">ç£åŠ›å¿«æœ - ä¸“ä¸šç‰ˆ</h1>
            <p class="hero-subtitle">æ™ºèƒ½æœç´¢ï¼Œäº‘ç«¯åŒæ­¥ï¼Œæè‡´ä½“éªŒ</p>
            
            <!-- æœç´¢æ¡† -->
            <div class="search-container">
                <div class="search-box">
                    <input 
                        type="text" 
                        id="searchInput" 
                        class="search-input" 
                        placeholder="è¯·è¾“å…¥ç•ªå·æˆ–å…³é”®è¯ï¼Œå¦‚ï¼šMIAA-123" 
                        autocomplete="off"
                        maxlength="100"
                        aria-label="æœç´¢è¾“å…¥æ¡†"
                    >
                    <button id="searchBtn" class="search-btn" title="å¼€å§‹æœç´¢" aria-label="æœç´¢">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="M21 21l-4.35-4.35"></path>
                        </svg>
                        <span>æœç´¢</span>
                    </button>
                </div>
                
                <!-- æœç´¢å»ºè®® -->
                <div id="searchSuggestions" class="search-suggestions" role="listbox">
                    <!-- åŠ¨æ€åŠ è½½å»ºè®® -->
                </div>
                
                <div class="search-options">
                    <label class="checkbox-label">
                        <input type="checkbox" id="cacheResults" checked aria-describedby="cache-desc">
                        <span>ğŸ’¾ ç¼“å­˜æœç´¢ç»“æœ</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="autoSync" checked aria-describedby="sync-desc">
                        <span>â˜ï¸ è‡ªåŠ¨åŒæ­¥åˆ°äº‘ç«¯</span>
                    </label>
                </div>
            </div>
        </section>

        <!-- å¿«é€Ÿæç¤º -->
        <section id="quickTips" class="quick-tips" style="display:none;">
            <div class="tips-content">
                <h3>ğŸ’¡ æœç´¢æŠ€å·§</h3>
                <ul>
                    <li>è¾“å…¥å®Œæ•´ç•ªå·è·å¾—æœ€ç²¾ç¡®ç»“æœï¼ˆå¦‚ï¼šMIAA-123ï¼‰</li>
                    <li>ä½¿ç”¨ç©ºæ ¼åˆ†éš”å¤šä¸ªå…³é”®è¯è¿›è¡Œç»„åˆæœç´¢</li>
                    <li>æ”¯æŒå¥³ä¼˜åç§°ã€åˆ¶ä½œå•†ç­‰å…³é”®è¯æœç´¢</li>
                    <li>ç™»å½•åå¯äº«å—äº‘ç«¯åŒæ­¥å’Œæ”¶è—åŠŸèƒ½</li>
                </ul>
            </div>
        </section>

        <!-- æœç´¢å†å² -->
        <section id="historySection" class="history-section" style="display:none;">
            <div class="section-header">
                <h2>ğŸ• æœç´¢å†å²</h2>
                <div class="section-actions">
                    <button id="clearHistoryBtn" class="btn btn-danger">æ¸…ç©ºå†å²</button>
                </div>
            </div>
            <div id="historyList" class="history-list">
                <!-- åŠ¨æ€åŠ è½½å†å²è®°å½• -->
            </div>
        </section>

        <!-- æœç´¢ç»“æœ -->
        <section id="resultsSection" class="results-section" style="display:none;">
            <div class="section-header">
                <h2>ğŸ” æœç´¢ç»“æœ</h2>
                <div class="section-actions">
                    <button id="exportResultsBtn" class="btn btn-success" style="display:none;">ğŸ“¤ å¯¼å‡ºç»“æœ</button>
                    <button id="clearResultsBtn" class="btn btn-secondary">ğŸ—‘ï¸ æ¸…ç©ºç»“æœ</button>
                </div>
            </div>
            <div id="searchInfo" class="search-info"></div>
            <div id="results" class="results-grid">
                <!-- åŠ¨æ€åŠ è½½æœç´¢ç»“æœ -->
            </div>
        </section>

        <!-- æ”¶è—å¤¹ -->
        <section class="favorites-section">
            <div class="section-header">
                <h2>â­ æˆ‘çš„æ”¶è—</h2>
                <div class="section-actions">
                    <button id="syncFavoritesBtn" class="btn btn-primary" style="display:none;">ğŸ”„ åŒæ­¥æ”¶è—</button>
                    <button id="importFavoritesBtn" class="btn btn-secondary" style="display:none;">ğŸ“¥ å¯¼å…¥æ”¶è—</button>
                </div>
            </div>
            <div id="favorites" class="favorites-grid">
                <div class="empty-state">
                    <span class="emoji">ğŸ“‹</span>
                    <h3>æš‚æ— æ”¶è—</h3>
                    <p>å¼€å§‹æœç´¢å¹¶æ”¶è—æ‚¨å–œæ¬¢çš„å†…å®¹å§</p>
                </div>
            </div>
        </section>

        <!-- ç«™ç‚¹å¯¼èˆª -->
        <section class="sites-section">
            <div class="section-header">
                <h2>ğŸŒ èµ„æºç«™ç‚¹å¯¼èˆª</h2>
            </div>
            <div class="sites-grid">
                <div class="site-category">
                    <h3>ğŸ“š ç•ªå·èµ„æ–™ç«™</h3>
                    <div class="site-list">
                        <a href="https://www.javlibrary.com/cn" target="_blank" class="site-item" rel="noopener noreferrer">
                            <div class="site-info">
                                <strong>JavLibrary</strong>
                                <span>è¯„è®ºæ´»è·ƒï¼Œå¥³ä¼˜æœç´¢è¯¦å°½ï¼Œèµ„æ–™åº“å®Œæ•´</span>
                            </div>
                        </a>
                        <a href="https://www.javbus.com" target="_blank" class="site-item" rel="noopener noreferrer">
                            <div class="site-info">
                                <strong>JavBus</strong>
                                <span>ç•ªå·+ç£åŠ›ä¸€ä½“ç«™ï¼Œä¿¡æ¯å®Œå–„ï¼Œæ›´æ–°åŠæ—¶</span>
                            </div>
                        </a>
                        <a href="https://javdb.com" target="_blank" class="site-item" rel="noopener noreferrer">
                            <div class="site-info">
                                <strong>JavDB</strong>
                                <span>æç®€é£æ ¼ç•ªå·èµ„æ–™ç«™ï¼Œè½»é‡å¿«é€Ÿè®¿é—®</span>
                            </div>
                        </a>
                    </div>
                </div>

                <div class="site-category">
                    <h3>ğŸ¥ åœ¨çº¿æ’­æ”¾å¹³å°</h3>
                    <div class="site-list">
                        <a href="https://jable.tv" target="_blank" class="site-item" rel="noopener noreferrer">
                            <div class="site-info">
                                <strong>Jable</strong>
                                <span>æ’­æ”¾é€Ÿåº¦å¿«ï¼Œè¿›åº¦å¯è·Ÿè¸ªï¼Œç•Œé¢å‹å¥½</span>
                            </div>
                        </a>
                        <a href="https://www5.javmost.com/" target="_blank" class="site-item" rel="noopener noreferrer">
                            <div class="site-info">
                                <strong>JavMost</strong>
                                <span>ç®€æ´ç•Œé¢ï¼Œä¸­æ–‡æ”¯æŒï¼Œèµ„æºä¸°å¯Œ</span>
                            </div>
                        </a>
                        <a href="https://jav.guru" target="_blank" class="site-item" rel="noopener noreferrer">
                            <div class="site-info">
                                <strong>JavGuru</strong>
                                <span>æ’­æ”¾+è¯„è®ºä¸€ä½“ï¼Œç¤¾åŒºåŠŸèƒ½å®Œå–„</span>
                            </div>
                        </a>
                    </div>
                </div>

                <div class="site-category">
                    <h3>ğŸ’¬ ç¤¾åŒºè®ºå›</h3>
                    <div class="site-list">
                        <a href="https://sehuatang.net" target="_blank" class="site-item" rel="noopener noreferrer">
                            <div class="site-info">
                                <strong>è‰²èŠ±å ‚</strong>
                                <span>ç½‘ç›˜èµ„æºä¸°å¯Œï¼Œç¤¾åŒºæ´»è·ƒï¼Œéœ€æ³¨å†Œç™»å½•</span>
                            </div>
                        </a>
                        <a href="https://t66y.com" target="_blank" class="site-item" rel="noopener noreferrer">
                            <div class="site-info">
                                <strong>è‰æ¦´ç¤¾åŒº</strong>
                                <span>è€ç‰Œè®ºå›ï¼Œå†å²æ‚ ä¹…ï¼Œéœ€ç§‘å­¦ä¸Šç½‘</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- ç™»å½•æ¨¡æ€æ¡† -->
    <div id="loginModal" class="modal" aria-labelledby="login-title" role="dialog" aria-modal="true">
        <div class="modal-content">
            <span class="close" aria-label="å…³é—­ç™»å½•çª—å£">&times;</span>
            <h2 id="login-title">ğŸ” ç”¨æˆ·ç™»å½•</h2>
            <form id="loginForm" novalidate>
                <div class="form-group">
                    <input 
                        type="text" 
                        id="loginUsername" 
                        placeholder="ç”¨æˆ·åæˆ–é‚®ç®±" 
                        required 
                        autocomplete="username"
                        maxlength="50"
                        aria-label="ç”¨æˆ·åæˆ–é‚®ç®±"
                    >
                </div>
                <div class="form-group">
                    <input 
                        type="password" 
                        id="loginPassword" 
                        placeholder="å¯†ç " 
                        required 
                        autocomplete="current-password"
                        maxlength="50"
                        aria-label="å¯†ç "
                    >
                </div>
                <button type="submit" class="submit-btn" id="loginSubmitBtn">
                    <span class="btn-text">ç™»å½•</span>
                    <span class="btn-loading" style="display:none;">ç™»å½•ä¸­...</span>
                </button>
                <div class="form-links">
                    <a href="#" id="showRegister">è¿˜æ²¡æœ‰è´¦å·ï¼Ÿç«‹å³æ³¨å†Œ</a>
                </div>
            </form>
        </div>
    </div>

    <!-- æ³¨å†Œæ¨¡æ€æ¡† -->
    <div id="registerModal" class="modal" aria-labelledby="register-title" role="dialog" aria-modal="true">
        <div class="modal-content">
            <span class="close" aria-label="å…³é—­æ³¨å†Œçª—å£">&times;</span>
            <h2 id="register-title">ğŸ“ ç”¨æˆ·æ³¨å†Œ</h2>
            <form id="registerForm" novalidate>
                <div class="form-group">
                    <input 
                        type="text" 
                        id="regUsername" 
                        placeholder="ç”¨æˆ·åï¼ˆ3-20ä¸ªå­—ç¬¦ï¼‰" 
                        required 
                        autocomplete="username"
                        maxlength="20"
                        minlength="3"
                        aria-label="ç”¨æˆ·å"
                    >
                </div>
                <div class="form-group">
                    <input 
                        type="email" 
                        id="regEmail" 
                        placeholder="é‚®ç®±åœ°å€" 
                        required 
                        autocomplete="email"
                        aria-label="é‚®ç®±åœ°å€"
                    >
                </div>
                <div class="form-group">
                    <input 
                        type="password" 
                        id="regPassword" 
                        placeholder="å¯†ç ï¼ˆè‡³å°‘8ä¸ªå­—ç¬¦ï¼‰" 
                        required 
                        autocomplete="new-password"
                        maxlength="50"
                        minlength="8"
                        aria-label="å¯†ç "
                    >
                </div>
                <div class="form-group">
                    <input 
                        type="password" 
                        id="regConfirmPassword" 
                        placeholder="ç¡®è®¤å¯†ç " 
                        required 
                        autocomplete="new-password"
                        maxlength="50"
                        aria-label="ç¡®è®¤å¯†ç "
                    >
                </div>
                <button type="submit" class="submit-btn" id="registerSubmitBtn">
                    <span class="btn-text">æ³¨å†Œ</span>
                    <span class="btn-loading" style="display:none;">æ³¨å†Œä¸­...</span>
                </button>
                <div class="form-links">
                    <a href="#" id="showLogin">å·²æœ‰è´¦å·ï¼Ÿç«‹å³ç™»å½•</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Toasté€šçŸ¥ -->
    <div id="toast" class="toast" role="alert" aria-live="polite">
        <div class="toast-content">
            <span class="toast-icon">â„¹ï¸</span>
            <span class="toast-message"></span>
        </div>
    </div>

    <!-- Loading -->
    <div id="loading" class="loading" style="display:none;" aria-label="åŠ è½½ä¸­">
        <div class="spinner"></div>
        <div class="loading-text">åŠ è½½ä¸­...</div>
    </div>

    <!-- è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨ -->
    <div id="connectionStatus" class="connection-status" style="display:none;" aria-live="polite">
        <span class="status-indicator" id="statusIndicator"></span>
        <span class="status-text" id="statusText">æ£€æŸ¥è¿æ¥...</span>
    </div>

    <!-- åŸºç¡€è„šæœ¬ -->
    <script>
        // å…¨å±€é…ç½®å’Œå·¥å…·å‡½æ•°
        window.AppConfig = {
            version: '2.0.0',
            apiBaseUrl: '',
            enableDebug: true,
            maxSearchHistory: 20,
            maxFavorites: 500,
            searchTimeout: 10000,
            retryCount: 3
        };

        // å·¥å…·å‡½æ•°åº“
        window.Utils = {
            // é˜²æŠ–å‡½æ•°
            debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            },

            // èŠ‚æµå‡½æ•°
            throttle(func, limit) {
                let inThrottle;
                return function() {
                    const args = arguments;
                    const context = this;
                    if (!inThrottle) {
                        func.apply(context, args);
                        inThrottle = true;
                        setTimeout(() => inThrottle = false, limit);
                    }
                }
            },

            // æ˜¾ç¤ºToast
            showToast(message, type = 'info', duration = 3000) {
                const toast = document.getElementById('toast');
                const toastMessage = toast.querySelector('.toast-message');
                const toastIcon = toast.querySelector('.toast-icon');
                
                // è®¾ç½®å›¾æ ‡
                const icons = {
                    success: 'âœ…',
                    error: 'âŒ',
                    warning: 'âš ï¸',
                    info: 'â„¹ï¸'
                };
                
                toastIcon.textContent = icons[type] || icons.info;
                toastMessage.textContent = message;
                
                // è®¾ç½®æ ·å¼
                toast.className = `toast ${type}`;
                toast.classList.add('show');
                
                // è‡ªåŠ¨éšè—
                setTimeout(() => {
                    toast.classList.remove('show');
                }, duration);
            },

            // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
            showLoading(text = 'åŠ è½½ä¸­...') {
                const loading = document.getElementById('loading');
                const loadingText = loading.querySelector('.loading-text');
                loadingText.textContent = text;
                loading.style.display = 'flex';
            },

            // éšè—åŠ è½½åŠ¨ç”»
            hideLoading() {
                document.getElementById('loading').style.display = 'none';
            },

            // æ ¼å¼åŒ–æ—¥æœŸ
            formatDate(date) {
                return new Intl.DateTimeFormat('zh-CN', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                }).format(new Date(date));
            },

            // éªŒè¯é‚®ç®±
            isValidEmail(email) {
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return re.test(email);
            },

            // ç”Ÿæˆå”¯ä¸€ID
            generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            },

            // æœ¬åœ°å­˜å‚¨å°è£…
            storage: {
                get(key, defaultValue = null) {
                    try {
                        const item = localStorage.getItem(key);
                        return item ? JSON.parse(item) : defaultValue;
                    } catch (e) {
                        console.error('Storage get error:', e);
                        return defaultValue;
                    }
                },

                set(key, value) {
                    try {
                        localStorage.setItem(key, JSON.stringify(value));
                        return true;
                    } catch (e) {
                        console.error('Storage set error:', e);
                        return false;
                    }
                },

                remove(key) {
                    try {
                        localStorage.removeItem(key);
                        return true;
                    } catch (e) {
                        console.error('Storage remove error:', e);
                        return false;
                    }
                }
            }
        };

        // ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
        class ThemeManager {
            constructor() {
                this.currentTheme = 'light';
                this.init();
            }

            init() {
                this.loadTheme();
                this.bindEvents();
            }

            loadTheme() {
                const savedTheme = Utils.storage.get('theme', 'auto');
                this.applyTheme(savedTheme);
            }

            applyTheme(theme) {
                if (theme === 'auto') {
                    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                    theme = prefersDark ? 'dark' : 'light';
                }

                document.documentElement.setAttribute('data-theme', theme);
                this.currentTheme = theme;
                this.updateThemeIcon();
                Utils.storage.set('theme', theme);
            }

            updateThemeIcon() {
                const themeIcon = document.getElementById('themeIcon');
                if (themeIcon) {
                    themeIcon.textContent = this.currentTheme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
                }
            }

            toggle() {
                const newTheme = this.currentTheme === 'dark' ? 'light' : 'dark';
                this.applyTheme(newTheme);
                
                // æ·»åŠ åˆ‡æ¢åŠ¨ç”»æ•ˆæœ
                document.body.style.transition = 'background-color 0.3s ease';
                setTimeout(() => {
                    document.body.style.transition = '';
                }, 300);
            }

            bindEvents() {
                const themeToggle = document.getElementById('themeToggle');
                if (themeToggle) {
                    themeToggle.addEventListener('click', () => this.toggle());
                }

                // ç›‘å¬ç³»ç»Ÿä¸»é¢˜å˜åŒ–
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                    if (Utils.storage.get('theme') === 'auto') {
                        this.applyTheme('auto');
                    }
                });
            }
        }

        // æœç´¢åŠŸèƒ½ç®¡ç†
        class SearchManager {
            constructor() {
                this.isSearching = false;
                this.searchHistory = Utils.storage.get('searchHistory', []);
                this.currentResults = [];
                this.init();
            }

            init() {
                this.bindEvents();
                this.loadSearchHistory();
                this.initSearchSuggestions();
            }

            bindEvents() {
                const searchInput = document.getElementById('searchInput');
                const searchBtn = document.getElementById('searchBtn');
                const clearHistoryBtn = document.getElementById('clearHistoryBtn');
                const clearResultsBtn = document.getElementById('clearResultsBtn');

                if (searchInput) {
                    searchInput.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter' && !this.isSearching) {
                            this.performSearch();
                        }
                    });

                    // æœç´¢å»ºè®®
                    searchInput.addEventListener('input', Utils.debounce((e) => {
                        this.showSearchSuggestions(e.target.value);
                    }, 300));

                    searchInput.addEventListener('focus', () => {
                        if (searchInput.value.trim()) {
                            this.showSearchSuggestions(searchInput.value);
                        }
                    });

                    searchInput.addEventListener('blur', () => {
                        setTimeout(() => this.hideSearchSuggestions(), 150);
                    });
                }

                if (searchBtn) {
                    searchBtn.addEventListener('click', () => {
                        if (!this.isSearching) {
                            this.performSearch();
                        }
                    });
                }

                if (clearHistoryBtn) {
                    clearHistoryBtn.addEventListener('click', () => this.clearHistory());
                }

                if (clearResultsBtn) {
                    clearResultsBtn.addEventListener('click', () => this.clearResults());
                }
            }

            async performSearch() {
                const searchInput = document.getElementById('searchInput');
                const query = searchInput?.value.trim();

                if (!query) {
                    Utils.showToast('è¯·è¾“å…¥æœç´¢å…³é”®è¯', 'warning');
                    return;
                }

                if (query.length < 2) {
                    Utils.showToast('æœç´¢å…³é”®è¯è‡³å°‘éœ€è¦2ä¸ªå­—ç¬¦', 'warning');
                    return;
                }

                this.isSearching = true;
                this.updateSearchButton(true);
                Utils.showLoading('æ­£åœ¨æœç´¢...');

                try {
                    // æ·»åŠ åˆ°æœç´¢å†å²
                    this.addToHistory(query);

                    // æ¨¡æ‹Ÿæœç´¢APIè°ƒç”¨
                    const results = await this.mockSearch(query);
                    
                    this.currentResults = results;
                    this.displayResults(results, query);
                    
                    Utils.showToast(`æ‰¾åˆ° ${results.length} ä¸ªç»“æœ`, 'success');

                } catch (error) {
                    console.error('Search error:', error);
                    Utils.showToast('æœç´¢å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
                } finally {
                    this.isSearching = false;
                    this.updateSearchButton(false);
                    Utils.hideLoading();
                    this.hideSearchSuggestions();
                }
            }

            async mockSearch(query) {
                // æ¨¡æ‹ŸAPIå»¶è¿Ÿ
                await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000));

                // æ¨¡æ‹Ÿæœç´¢ç»“æœ
                const mockResults = [];
                const resultCount = Math.floor(Math.random() * 20) + 5;

                for (let i = 0; i < resultCount; i++) {
                    mockResults.push({
                        id: Utils.generateId(),
                        title: `${query} - ç»“æœ ${i + 1}`,
                        subtitle: `è¿™æ˜¯å…³äº"${query}"çš„æœç´¢ç»“æœæè¿°ä¿¡æ¯`,
                        url: `https://example.com/result/${i + 1}`,
                        type: Math.random() > 0.5 ? 'video' : 'magnet',
                        size: `${(Math.random() * 5 + 1).toFixed(1)} GB`,
                        date: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000),
                        seeds: Math.floor(Math.random() * 100),
                        peers: Math.floor(Math.random() * 50)
                    });
                }

                return mockResults;
            }

            displayResults(results, query) {
                const resultsSection = document.getElementById('resultsSection');
                const searchInfo = document.getElementById('searchInfo');
                const resultsGrid = document.getElementById('results');

                if (!resultsSection || !resultsGrid) return;

                // æ˜¾ç¤ºæœç´¢ä¿¡æ¯
                if (searchInfo) {
                    searchInfo.innerHTML = `
                        <strong>æœç´¢å…³é”®è¯ï¼š</strong>"${query}" 
                        <strong>æ‰¾åˆ°ç»“æœï¼š</strong>${results.length} ä¸ª
                        <strong>æœç´¢æ—¶é—´ï¼š</strong>${new Date().toLocaleString()}
                    `;
                }

                // æ¸…ç©ºå¹¶æ˜¾ç¤ºç»“æœ
                resultsGrid.innerHTML = '';
                
                if (results.length === 0) {
                    resultsGrid.innerHTML = `
                        <div class="empty-state">
                            <span class="emoji">ğŸ”</span>
                            <h3>æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</h3>
                            <p>å°è¯•ä½¿ç”¨å…¶ä»–å…³é”®è¯æˆ–æ£€æŸ¥æ‹¼å†™</p>
                        </div>
                    `;
                } else {
                    results.forEach(result => {
                        const resultElement = this.createResultElement(result);
                        resultsGrid.appendChild(resultElement);
                    });
                }

                // æ˜¾ç¤ºç»“æœåŒºåŸŸ
                resultsSection.style.display = 'block';
                resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

                // æ˜¾ç¤ºå¯¼å‡ºæŒ‰é’®
                const exportBtn = document.getElementById('exportResultsBtn');
                if (exportBtn && results.length > 0) {
                    exportBtn.style.display = 'inline-flex';
                    exportBtn.onclick = () => this.exportResults(results, query);
                }
            }

            createResultElement(result) {
                const div = document.createElement('div');
                div.className = 'result-item';
                div.style.animation = 'slideInUp 0.6s ease forwards';
                
                div.innerHTML = `
                    <div class="result-image">
                        <span class="result-type-icon">${result.type === 'video' ? 'ğŸ¬' : 'ğŸ§²'}</span>
                    </div>
                    <h3 class="result-title">${this.highlightQuery(result.title)}</h3>
                    <p class="result-subtitle">${result.subtitle}</p>
                    <div class="result-meta">
                        <span class="result-size">ğŸ“¦ ${result.size}</span>
                        <span class="result-seeds">ğŸŒ± ${result.seeds}</span>
                        <span class="result-date">ğŸ“… ${Utils.formatDate(result.date)}</span>
                    </div>
                    <div class="result-actions">
                        <button class="btn btn-primary visit-btn" onclick="window.open('${result.url}', '_blank')">
                            ğŸ”— è®¿é—®
                        </button>
                        <button class="btn favorite-btn ${this.isFavorited(result.id) ? 'favorited btn-success' : 'btn-warning'}" 
                                onclick="favoriteManager.toggleFavorite('${result.id}', this)">
                            ${this.isFavorited(result.id) ? 'â¤ï¸ å·²æ”¶è—' : 'â­ æ”¶è—'}
                        </button>
                    </div>
                `;

                return div;
            }

            highlightQuery(text) {
                const searchInput = document.getElementById('searchInput');
                const query = searchInput?.value.trim();
                if (!query) return text;

                const regex = new RegExp(`(${query})`, 'gi');
                return text.replace(regex, '<mark>$1</mark>');
            }

            isFavorited(id) {
                const favorites = Utils.storage.get('favorites', []);
                return favorites.some(fav => fav.id === id);
            }

            addToHistory(query) {
                // é¿å…é‡å¤
                this.searchHistory = this.searchHistory.filter(item => item.query !== query);
                
                // æ·»åŠ åˆ°å¼€å¤´
                this.searchHistory.unshift({
                    query: query,
                    timestamp: new Date().toISOString(),
                    id: Utils.generateId()
                });

                // é™åˆ¶å†å²è®°å½•æ•°é‡
                if (this.searchHistory.length > window.AppConfig.maxSearchHistory) {
                    this.searchHistory = this.searchHistory.slice(0, window.AppConfig.maxSearchHistory);
                }

                Utils.storage.set('searchHistory', this.searchHistory);
                this.loadSearchHistory();
            }

            loadSearchHistory() {
                const historyList = document.getElementById('historyList');
                const historySection = document.getElementById('historySection');

                if (!historyList) return;

                if (this.searchHistory.length === 0) {
                    historySection.style.display = 'none';
                    return;
                }

                historyList.innerHTML = '';
                this.searchHistory.slice(0, 10).forEach(item => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    historyItem.textContent = item.query;
                    historyItem.onclick = () => {
                        const searchInput = document.getElementById('searchInput');
                        if (searchInput) {
                            searchInput.value = item.query;
                            this.performSearch();
                        }
                    };
                }

                // æ¨¡æ‹Ÿç™»å½•å¤±è´¥
                if (Math.random() > 0.8) {
                    return {
                        success: false,
                        message: 'æœåŠ¡å™¨ç¹å¿™ï¼Œè¯·ç¨åé‡è¯•'
                    };
                }

                return {
                    success: false,
                    message: 'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯'
                };
            }

            async mockRegister(username, email, password) {
                // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
                await new Promise(resolve => setTimeout(resolve, 2000));

                // æ¨¡æ‹Ÿç”¨æˆ·åå·²å­˜åœ¨
                if (username.toLowerCase() === 'admin' || username.toLowerCase() === 'test') {
                    return {
                        success: false,
                        message: 'ç”¨æˆ·åå·²å­˜åœ¨ï¼Œè¯·é€‰æ‹©å…¶ä»–ç”¨æˆ·å'
                    };
                }

                // æ¨¡æ‹Ÿé‚®ç®±å·²å­˜åœ¨
                if (email === 'test@example.com') {
                    return {
                        success: false,
                        message: 'è¯¥é‚®ç®±å·²è¢«æ³¨å†Œ'
                    };
                }

                // æ¨¡æ‹Ÿæ³¨å†Œå¤±è´¥
                if (Math.random() > 0.9) {
                    return {
                        success: false,
                        message: 'æ³¨å†ŒæœåŠ¡æš‚æ—¶ä¸å¯ç”¨'
                    };
                }

                return {
                    success: true,
                    message: 'æ³¨å†ŒæˆåŠŸ'
                };
            }

            logout() {
                if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                    this.isLoggedIn = false;
                    this.currentUser = null;
                    
                    Utils.storage.remove('auth_token');
                    Utils.storage.remove('user_data');
                    
                    this.updateUI();
                    this.showLoginModal();
                    
                    // æ¸…ç©ºæ•æ„Ÿæ•°æ®
                    searchManager.clearResults();
                    favoriteManager.favorites = [];
                    favoriteManager.loadFavorites();
                    
                    Utils.showToast('å·²é€€å‡ºç™»å½•', 'info');
                }
            }

            showLoginModal() {
                this.hideModals();
                const modal = document.getElementById('loginModal');
                if (modal) {
                    modal.style.display = 'block';
                    // é‡ç½®è¡¨å•
                    const form = document.getElementById('loginForm');
                    if (form) form.reset();
                }
                document.querySelector('.main-content').style.display = 'none';
            }

            showRegisterModal() {
                this.hideModals();
                const modal = document.getElementById('registerModal');
                if (modal) {
                    modal.style.display = 'block';
                    // é‡ç½®è¡¨å•
                    const form = document.getElementById('registerForm');
                    if (form) form.reset();
                }
            }

            hideModals() {
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => {
                    modal.style.display = 'none';
                });
            }

            showMainContent() {
                document.querySelector('.main-content').style.display = 'block';
            }

            updateUI() {
                const userMenu = document.getElementById('userMenu');
                const loginBtn = document.getElementById('loginBtn');
                const userInfo = document.getElementById('userInfo');
                const username = document.getElementById('username');

                if (!userMenu) return;

                if (this.isLoggedIn && this.currentUser) {
                    loginBtn.style.display = 'none';
                    userInfo.style.display = 'flex';
                    if (username) {
                        username.textContent = this.currentUser.username;
                    }

                    // æ˜¾ç¤ºåŒæ­¥ç›¸å…³æŒ‰é’®
                    const syncButtons = document.querySelectorAll('[id$="SyncBtn"], [id$="syncBtn"]');
                    syncButtons.forEach(btn => {
                        btn.style.display = 'inline-flex';
                    });
                } else {
                    loginBtn.style.display = 'inline-flex';
                    userInfo.style.display = 'none';

                    // éšè—åŒæ­¥ç›¸å…³æŒ‰é’®
                    const syncButtons = document.querySelectorAll('[id$="SyncBtn"], [id$="syncBtn"]');
                    syncButtons.forEach(btn => {
                        btn.style.display = 'none';
                    });
                }
            }

            setSubmitButtonState(button, isLoading) {
                if (!button) return;

                const btnText = button.querySelector('.btn-text');
                const btnLoading = button.querySelector('.btn-loading');

                if (isLoading) {
                    button.disabled = true;
                    if (btnText) btnText.style.display = 'none';
                    if (btnLoading) btnLoading.style.display = 'inline';
                } else {
                    button.disabled = false;
                    if (btnText) btnText.style.display = 'inline';
                    if (btnLoading) btnLoading.style.display = 'none';
                }
            }
        }

        // è¿æ¥çŠ¶æ€ç®¡ç†
        class ConnectionManager {
            constructor() {
                this.isOnline = navigator.onLine;
                this.lastPingTime = null;
                this.pingInterval = null;
                this.init();
            }

            init() {
                this.bindEvents();
                this.startPing();
                this.updateStatus();
            }

            bindEvents() {
                window.addEventListener('online', () => {
                    this.isOnline = true;
                    this.updateStatus();
                    Utils.showToast('ç½‘ç»œè¿æ¥å·²æ¢å¤', 'success');
                });

                window.addEventListener('offline', () => {
                    this.isOnline = false;
                    this.updateStatus();
                    Utils.showToast('ç½‘ç»œè¿æ¥å·²æ–­å¼€', 'error');
                });
            }

            startPing() {
                this.pingInterval = setInterval(async () => {
                    await this.checkConnection();
                }, 30000); // æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
            }

            async checkConnection() {
                try {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 5000);

                    const response = await fetch('/api/ping', {
                        method: 'HEAD',
                        signal: controller.signal
                    });

                    clearTimeout(timeoutId);
                    
                    this.isOnline = response.ok;
                    this.lastPingTime = new Date();
                } catch (error) {
                    this.isOnline = false;
                }

                this.updateStatus();
            }

            updateStatus() {
                const statusElement = document.getElementById('connectionStatus');
                const indicator = document.getElementById('statusIndicator');
                const statusText = document.getElementById('statusText');

                if (!statusElement || !indicator || !statusText) return;

                if (this.isOnline) {
                    indicator.className = 'status-indicator connected';
                    statusText.textContent = 'è¿æ¥æ­£å¸¸';
                    statusElement.style.display = 'none'; // æ­£å¸¸æ—¶éšè—
                } else {
                    indicator.className = 'status-indicator error';
                    statusText.textContent = 'ç½‘ç»œå¼‚å¸¸';
                    statusElement.style.display = 'flex';
                }
            }

            destroy() {
                if (this.pingInterval) {
                    clearInterval(this.pingInterval);
                }
            }
        }

        // åº”ç”¨ä¸»ç±»
        class MagnetSearchApp {
            constructor() {
                this.version = window.AppConfig.version;
                this.isInitialized = false;
                this.init();
            }

            async init() {
                try {
                    console.log(`ğŸš€ åˆå§‹åŒ–ç£åŠ›å¿«æœ v${this.version}`);

                    // åˆå§‹åŒ–å„ä¸ªç®¡ç†å™¨
                    this.themeManager = new ThemeManager();
                    this.authManager = new AuthManager();
                    this.connectionManager = new ConnectionManager();
                    
                    // ç­‰å¾…è®¤è¯å®Œæˆååˆå§‹åŒ–å…¶ä»–åŠŸèƒ½
                    await this.waitForAuth();
                    
                    window.searchManager = new SearchManager();
                    window.favoriteManager = new FavoriteManager();

                    this.bindGlobalEvents();
                    this.initAnimations();
                    this.checkFirstVisit();
                    
                    this.isInitialized = true;
                    console.log('âœ… åº”ç”¨åˆå§‹åŒ–å®Œæˆ');

                } catch (error) {
                    console.error('âŒ åº”ç”¨åˆå§‹åŒ–å¤±è´¥:', error);
                    Utils.showToast('åº”ç”¨åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•', 'error');
                }
            }

            async waitForAuth() {
                // ç­‰å¾…è®¤è¯çŠ¶æ€ç¡®å®š
                let attempts = 0;
                while (!this.authManager.isLoggedIn && attempts < 50) {
                    await new Promise(resolve => setTimeout(resolve, 100));
                    attempts++;
                }
            }

            bindGlobalEvents() {
                // æ»šåŠ¨æ•ˆæœ
                let lastScrollY = 0;
                window.addEventListener('scroll', Utils.throttle(() => {
                    const navbar = document.getElementById('navbar');
                    if (navbar) {
                        if (window.scrollY > 100) {
                            navbar.classList.add('scrolled');
                        } else {
                            navbar.classList.remove('scrolled');
                        }
                    }
                    lastScrollY = window.scrollY;
                }, 10));

                // é”®ç›˜å¿«æ·é”®
                document.addEventListener('keydown', (e) => {
                    // Ctrl/Cmd + K èšç„¦æœç´¢æ¡†
                    if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                        e.preventDefault();
                        const searchInput = document.getElementById('searchInput');
                        if (searchInput) {
                            searchInput.focus();
                            searchInput.select();
                        }
                    }

                    // ESC å…³é—­æ¨¡æ€æ¡†
                    if (e.key === 'Escape') {
                        this.authManager.hideModals();
                        if (window.searchManager) {
                            window.searchManager.hideSearchSuggestions();
                        }
                    }
                });

                // é¡µé¢å¯è§æ€§å˜åŒ–
                document.addEventListener('visibilitychange', () => {
                    if (!document.hidden && this.isInitialized) {
                        this.connectionManager.checkConnection();
                    }
                });

                // é”™è¯¯å¤„ç†
                window.addEventListener('error', (e) => {
                    console.error('å…¨å±€é”™è¯¯:', e.error);
                    if (window.AppConfig.enableDebug) {
                        Utils.showToast('å‘ç”Ÿé”™è¯¯ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°', 'error');
                    }
                });

                // æœªå¤„ç†çš„Promiseæ‹’ç»
                window.addEventListener('unhandledrejection', (e) => {
                    console.error('æœªå¤„ç†çš„Promiseæ‹’ç»:', e.reason);
                    e.preventDefault();
                });
            }

            initAnimations() {
                // é¡µé¢åŠ è½½åŠ¨ç”»
                const elementsToAnimate = document.querySelectorAll('.hero, section, .site-category');
                
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach((entry, index) => {
                        if (entry.isIntersecting) {
                            entry.target.style.animation = `slideInUp 0.8s ease ${index * 0.1}s forwards`;
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1 });

                elementsToAnimate.forEach(el => {
                    observer.observe(el);
                });
            }

            checkFirstVisit() {
                const isFirstVisit = !Utils.storage.get('visited_before');
                if (isFirstVisit) {
                    Utils.storage.set('visited_before', true);
                    
                    // æ˜¾ç¤ºå¿«é€Ÿæç¤º
                    setTimeout(() => {
                        const quickTips = document.getElementById('quickTips');
                        if (quickTips) {
                            quickTips.style.display = 'block';
                        }
                    }, 2000);

                    // æ¬¢è¿æ¶ˆæ¯
                    setTimeout(() => {
                        Utils.showToast('æ¬¢è¿ä½¿ç”¨ç£åŠ›å¿«æœï¼å¼€å§‹æ‚¨çš„æœç´¢ä¹‹æ—…å§ ğŸ‰', 'success', 5000);
                    }, 1000);
                }
            }

            checkConnectionStatus() {
                if (this.connectionManager) {
                    this.connectionManager.checkConnection();
                }
            }

            destroy() {
                if (this.connectionManager) {
                    this.connectionManager.destroy();
                }
            }
        }

        // å…¨å±€å‡½æ•°
        function navigateToDashboard() {
            if (window.authManager && window.authManager.isLoggedIn) {
                window.location.href = 'dashboard.html';
            } else {
                Utils.showToast('è¯·å…ˆç™»å½•', 'warning');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸ“± é¡µé¢DOMåŠ è½½å®Œæˆ');

            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            const authToken = Utils.storage.get('auth_token');
            if (authToken) {
                document.querySelector('.main-content').style.display = 'block';
            }

            // æ›´æ–°é¡µé¢æ ‡é¢˜å’Œå“ç‰Œåç§°
            const appName = 'ç£åŠ›å¿«æœ';
            document.getElementById('page-title').textContent = `${appName} - ä¸“ä¸šç‰ˆ`;
            document.getElementById('brand-text').textContent = appName;
            document.getElementById('hero-title').textContent = `${appName} - ä¸“ä¸šç‰ˆ`;

            // åˆ›å»ºåº”ç”¨å®ä¾‹
            window.app = new MagnetSearchApp();

            // å¼€å‘æ¨¡å¼ä¸‹çš„è°ƒè¯•ä¿¡æ¯
            if (window.AppConfig.enableDebug) {
                console.log('ğŸ”§ è°ƒè¯•æ¨¡å¼å·²å¯ç”¨');
                window.debug = {
                    app: window.app,
                    utils: window.Utils,
                    config: window.AppConfig
                };
            }
        });

        // Service Worker æ³¨å†Œï¼ˆPWAæ”¯æŒï¼‰
        if ('serviceWorker' in navigator && window.location.protocol === 'https:') {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('âœ… Service Worker æ³¨å†ŒæˆåŠŸ');
                    })
                    .catch(error => {
                        console.log('âŒ Service Worker æ³¨å†Œå¤±è´¥:', error);
                    });
            });
        }

        // é¡µé¢å¸è½½æ—¶çš„æ¸…ç†å·¥ä½œ
        window.addEventListener('beforeunload', () => {
            if (window.app) {
                window.app.destroy();
            }
        });
    </script>
</body>
</html>
                    historyList.appendChild(historyItem);
                });

                historySection.style.display = 'block';
            }

            clearHistory() {
                if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æœç´¢å†å²å—ï¼Ÿ')) {
                    this.searchHistory = [];
                    Utils.storage.remove('searchHistory');
                    this.loadSearchHistory();
                    Utils.showToast('æœç´¢å†å²å·²æ¸…ç©º', 'success');
                }
            }

            clearResults() {
                const resultsSection = document.getElementById('resultsSection');
                const resultsGrid = document.getElementById('results');
                const exportBtn = document.getElementById('exportResultsBtn');

                if (resultsGrid) resultsGrid.innerHTML = '';
                if (resultsSection) resultsSection.style.display = 'none';
                if (exportBtn) exportBtn.style.display = 'none';

                this.currentResults = [];
                Utils.showToast('æœç´¢ç»“æœå·²æ¸…ç©º', 'success');
            }

            exportResults(results, query) {
                const data = {
                    query: query,
                    timestamp: new Date().toISOString(),
                    resultCount: results.length,
                    results: results.map(r => ({
                        title: r.title,
                        url: r.url,
                        size: r.size,
                        type: r.type,
                        date: r.date
                    }))
                };

                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `search-results-${query}-${new Date().getTime()}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                Utils.showToast('æœç´¢ç»“æœå·²å¯¼å‡º', 'success');
            }

            updateSearchButton(isSearching) {
                const searchBtn = document.getElementById('searchBtn');
                if (!searchBtn) return;

                const btnText = searchBtn.querySelector('span');
                const btnIcon = searchBtn.querySelector('svg');

                if (isSearching) {
                    searchBtn.disabled = true;
                    if (btnText) btnText.textContent = 'æœç´¢ä¸­...';
                    if (btnIcon) btnIcon.style.display = 'none';
                } else {
                    searchBtn.disabled = false;
                    if (btnText) btnText.textContent = 'æœç´¢';
                    if (btnIcon) btnIcon.style.display = 'block';
                }
            }

            initSearchSuggestions() {
                this.commonSuggestions = [
                    'MIAA-', 'SSIS-', 'STARS-', 'FSDSS-', 'MIDE-',
                    'IPX-', 'SSNI-', 'CAWD-', 'PPPD-', 'JUFE-'
                ];
            }

            showSearchSuggestions(query) {
                const suggestionsContainer = document.getElementById('searchSuggestions');
                if (!suggestionsContainer || !query || query.length < 1) {
                    this.hideSearchSuggestions();
                    return;
                }

                const suggestions = this.generateSuggestions(query);
                if (suggestions.length === 0) {
                    this.hideSearchSuggestions();
                    return;
                }

                suggestionsContainer.innerHTML = suggestions.map(suggestion => `
                    <div class="suggestion-item" onclick="searchManager.selectSuggestion('${suggestion}')">
                        <span class="suggestion-icon">${this.getSuggestionIcon(suggestion)}</span>
                        <span class="suggestion-text">${this.highlightSuggestion(suggestion, query)}</span>
                    </div>
                `).join('');

                suggestionsContainer.classList.add('show');
            }

            hideSearchSuggestions() {
                const suggestionsContainer = document.getElementById('searchSuggestions');
                if (suggestionsContainer) {
                    suggestionsContainer.classList.remove('show');
                }
            }

            generateSuggestions(query) {
                const suggestions = new Set();
                const lowerQuery = query.toLowerCase();

                // ä»å†å²è®°å½•ä¸­æŸ¥æ‰¾
                this.searchHistory.forEach(item => {
                    if (item.query.toLowerCase().includes(lowerQuery)) {
                        suggestions.add(item.query);
                    }
                });

                // ä»å¸¸ç”¨å»ºè®®ä¸­æŸ¥æ‰¾
                this.commonSuggestions.forEach(suggestion => {
                    if (suggestion.toLowerCase().includes(lowerQuery)) {
                        suggestions.add(suggestion + (Math.floor(Math.random() * 999) + 1).toString().padStart(3, '0'));
                    }
                });

                return Array.from(suggestions).slice(0, 8);
            }

            getSuggestionIcon(suggestion) {
                if (this.searchHistory.some(h => h.query === suggestion)) {
                    return 'ğŸ•';
                }
                return 'ğŸ”';
            }

            highlightSuggestion(suggestion, query) {
                const regex = new RegExp(`(${query})`, 'gi');
                return suggestion.replace(regex, '<strong>$1</strong>');
            }

            selectSuggestion(suggestion) {
                const searchInput = document.getElementById('searchInput');
                if (searchInput) {
                    searchInput.value = suggestion;
                    this.hideSearchSuggestions();
                    this.performSearch();
                }
            }
        }

        // æ”¶è—åŠŸèƒ½ç®¡ç†
        class FavoriteManager {
            constructor() {
                this.favorites = Utils.storage.get('favorites', []);
                this.init();
            }

            init() {
                this.loadFavorites();
                this.bindEvents();
            }

            bindEvents() {
                const syncBtn = document.getElementById('syncFavoritesBtn');
                const importBtn = document.getElementById('importFavoritesBtn');

                if (syncBtn) {
                    syncBtn.addEventListener('click', () => this.syncFavorites());
                }

                if (importBtn) {
                    importBtn.addEventListener('click', () => this.importFavorites());
                }
            }

            toggleFavorite(id, buttonElement) {
                const existingIndex = this.favorites.findIndex(fav => fav.id === id);

                if (existingIndex >= 0) {
                    // ç§»é™¤æ”¶è—
                    this.favorites.splice(existingIndex, 1);
                    if (buttonElement) {
                        buttonElement.innerHTML = 'â­ æ”¶è—';
                        buttonElement.className = 'btn favorite-btn btn-warning';
                    }
                    Utils.showToast('å·²å–æ¶ˆæ”¶è—', 'info');
                } else {
                    // æ·»åŠ æ”¶è—
                    const result = searchManager.currentResults.find(r => r.id === id);
                    if (result) {
                        if (this.favorites.length >= window.AppConfig.maxFavorites) {
                            Utils.showToast(`æ”¶è—å¤¹å·²æ»¡ï¼Œæœ€å¤šæ”¯æŒ${window.AppConfig.maxFavorites}ä¸ªæ”¶è—`, 'warning');
                            return;
                        }

                        this.favorites.push({
                            ...result,
                            favoriteTime: new Date().toISOString()
                        });

                        if (buttonElement) {
                            buttonElement.innerHTML = 'â¤ï¸ å·²æ”¶è—';
                            buttonElement.className = 'btn favorite-btn favorited btn-success';
                        }
                        Utils.showToast('å·²æ·»åŠ åˆ°æ”¶è—', 'success');
                    }
                }

                Utils.storage.set('favorites', this.favorites);
                this.loadFavorites();
            }

            loadFavorites() {
                const favoritesGrid = document.getElementById('favorites');
                if (!favoritesGrid) return;

                if (this.favorites.length === 0) {
                    favoritesGrid.innerHTML = `
                        <div class="empty-state">
                            <span class="emoji">ğŸ“‹</span>
                            <h3>æš‚æ— æ”¶è—</h3>
                            <p>å¼€å§‹æœç´¢å¹¶æ”¶è—æ‚¨å–œæ¬¢çš„å†…å®¹å§</p>
                        </div>
                    `;
                    return;
                }

                favoritesGrid.innerHTML = '';
                this.favorites.forEach((favorite, index) => {
                    const favoriteElement = this.createFavoriteElement(favorite, index);
                    favoritesGrid.appendChild(favoriteElement);
                });
            }

            createFavoriteElement(favorite, index) {
                const div = document.createElement('div');
                div.className = 'favorite-item';
                div.style.animation = `slideInUp 0.6s ease ${index * 0.1}s forwards`;
                
                div.innerHTML = `
                    <h3 class="favorite-title">${favorite.title}</h3>
                    <div class="favorite-url">${favorite.url}</div>
                    <div class="favorite-meta">
                        <span>ğŸ“¦ ${favorite.size}</span>
                        <span>ğŸ“… ${Utils.formatDate(favorite.favoriteTime)}</span>
                    </div>
                    <div class="favorite-actions">
                        <button class="btn btn-primary" onclick="window.open('${favorite.url}', '_blank')">
                            ğŸ”— è®¿é—®
                        </button>
                        <button class="btn btn-danger" onclick="favoriteManager.removeFavorite('${favorite.id}')">
                            ğŸ—‘ï¸ ç§»é™¤
                        </button>
                    </div>
                `;

                return div;
            }

            removeFavorite(id) {
                if (confirm('ç¡®å®šè¦ç§»é™¤è¿™ä¸ªæ”¶è—å—ï¼Ÿ')) {
                    this.favorites = this.favorites.filter(fav => fav.id !== id);
                    Utils.storage.set('favorites', this.favorites);
                    this.loadFavorites();
                    Utils.showToast('æ”¶è—å·²ç§»é™¤', 'success');
                }
            }

            async syncFavorites() {
                Utils.showLoading('æ­£åœ¨åŒæ­¥æ”¶è—...');
                
                try {
                    // æ¨¡æ‹ŸåŒæ­¥APIè°ƒç”¨
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    Utils.showToast('æ”¶è—åŒæ­¥æˆåŠŸ', 'success');
                } catch (error) {
                    Utils.showToast('æ”¶è—åŒæ­¥å¤±è´¥', 'error');
                } finally {
                    Utils.hideLoading();
                }
            }

            importFavorites() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            try {
                                const data = JSON.parse(e.target.result);
                                if (Array.isArray(data)) {
                                    this.favorites = [...this.favorites, ...data];
                                    Utils.storage.set('favorites', this.favorites);
                                    this.loadFavorites();
                                    Utils.showToast(`æˆåŠŸå¯¼å…¥${data.length}ä¸ªæ”¶è—`, 'success');
                                } else {
                                    throw new Error('Invalid format');
                                }
                            } catch (error) {
                                Utils.showToast('å¯¼å…¥æ–‡ä»¶æ ¼å¼é”™è¯¯', 'error');
                            }
                        };
                        reader.readAsText(file);
                    }
                };
                input.click();
            }
        }

        // è®¤è¯ç®¡ç†
        class AuthManager {
            constructor() {
                this.isLoggedIn = false;
                this.currentUser = null;
                this.init();
            }

            init() {
                this.checkLoginStatus();
                this.bindEvents();
            }

            checkLoginStatus() {
                const token = Utils.storage.get('auth_token');
                const userData = Utils.storage.get('user_data');

                if (token && userData) {
                    this.isLoggedIn = true;
                    this.currentUser = userData;
                    this.updateUI();
                    this.showMainContent();
                } else {
                    this.showLoginModal();
                }
            }

            bindEvents() {
                // ç™»å½•ç›¸å…³
                const loginBtn = document.getElementById('loginBtn');
                const loginForm = document.getElementById('loginForm');
                const showRegister = document.getElementById('showRegister');
                
                // æ³¨å†Œç›¸å…³
                const registerForm = document.getElementById('registerForm');
                const showLogin = document.getElementById('showLogin');
                
                // ç™»å‡º
                const logoutBtn = document.getElementById('logoutBtn');

                // æ¨¡æ€æ¡†å…³é—­
                const closeButtons = document.querySelectorAll('.close');

                if (loginBtn) {
                    loginBtn.addEventListener('click', () => this.showLoginModal());
                }

                if (loginForm) {
                    loginForm.addEventListener('submit', (e) => this.handleLogin(e));
                }

                if (registerForm) {
                    registerForm.addEventListener('submit', (e) => this.handleRegister(e));
                }

                if (showRegister) {
                    showRegister.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.showRegisterModal();
                    });
                }

                if (showLogin) {
                    showLogin.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.showLoginModal();
                    });
                }

                if (logoutBtn) {
                    logoutBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.logout();
                    });
                }

                closeButtons.forEach(btn => {
                    btn.addEventListener('click', () => this.hideModals());
                });

                // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
                window.addEventListener('click', (e) => {
                    if (e.target.classList.contains('modal')) {
                        this.hideModals();
                    }
                });
            }

            async handleLogin(e) {
                e.preventDefault();
                
                const username = document.getElementById('loginUsername').value.trim();
                const password = document.getElementById('loginPassword').value;
                const submitBtn = document.getElementById('loginSubmitBtn');

                if (!username || !password) {
                    Utils.showToast('è¯·å¡«å†™å®Œæ•´çš„ç™»å½•ä¿¡æ¯', 'warning');
                    return;
                }

                this.setSubmitButtonState(submitBtn, true);

                try {
                    // æ¨¡æ‹Ÿç™»å½•APIè°ƒç”¨
                    const result = await this.mockLogin(username, password);
                    
                    if (result.success) {
                        this.isLoggedIn = true;
                        this.currentUser = result.user;
                        
                        Utils.storage.set('auth_token', result.token);
                        Utils.storage.set('user_data', result.user);
                        
                        this.updateUI();
                        this.hideModals();
                        this.showMainContent();
                        
                        Utils.showToast(`æ¬¢è¿å›æ¥ï¼Œ${result.user.username}ï¼`, 'success');
                    } else {
                        Utils.showToast(result.message || 'ç™»å½•å¤±è´¥', 'error');
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    Utils.showToast('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
                } finally {
                    this.setSubmitButtonState(submitBtn, false);
                }
            }

            async handleRegister(e) {
                e.preventDefault();
                
                const username = document.getElementById('regUsername').value.trim();
                const email = document.getElementById('regEmail').value.trim();
                const password = document.getElementById('regPassword').value;
                const confirmPassword = document.getElementById('regConfirmPassword').value;
                const submitBtn = document.getElementById('registerSubmitBtn');

                // è¡¨å•éªŒè¯
                if (!username || !email || !password || !confirmPassword) {
                    Utils.showToast('è¯·å¡«å†™å®Œæ•´çš„æ³¨å†Œä¿¡æ¯', 'warning');
                    return;
                }

                if (username.length < 3 || username.length > 20) {
                    Utils.showToast('ç”¨æˆ·åé•¿åº¦åº”ä¸º3-20ä¸ªå­—ç¬¦', 'warning');
                    return;
                }

                if (!Utils.isValidEmail(email)) {
                    Utils.showToast('è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€', 'warning');
                    return;
                }

                if (password.length < 8) {
                    Utils.showToast('å¯†ç é•¿åº¦è‡³å°‘8ä¸ªå­—ç¬¦', 'warning');
                    return;
                }

                if (password !== confirmPassword) {
                    Utils.showToast('ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´', 'warning');
                    return;
                }

                this.setSubmitButtonState(submitBtn, true);

                try {
                    // æ¨¡æ‹Ÿæ³¨å†ŒAPIè°ƒç”¨
                    const result = await this.mockRegister(username, email, password);
                    
                    if (result.success) {
                        Utils.showToast('æ³¨å†ŒæˆåŠŸï¼è¯·ç™»å½•', 'success');
                        this.showLoginModal();
                        
                        // è‡ªåŠ¨å¡«å……ç”¨æˆ·å
                        const loginUsername = document.getElementById('loginUsername');
                        if (loginUsername) {
                            loginUsername.value = username;
                        }
                    } else {
                        Utils.showToast(result.message || 'æ³¨å†Œå¤±è´¥', 'error');
                    }
                } catch (error) {
                    console.error('Register error:', error);
                    Utils.showToast('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
                } finally {
                    this.setSubmitButtonState(submitBtn, false);
                }
            }

            async mockLogin(username, password) {
                // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
                await new Promise(resolve => setTimeout(resolve, 1500));

                // ç®€å•çš„æ¨¡æ‹ŸéªŒè¯
                if (username === 'demo' && password === '12345678') {
                    return {
                        success: true,
                        token: 'mock_token_' + Date.now(),
                        user: {
                            id: 1,
                            username: 'demo',
                            email: 'demo@example.com',
                            avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=demo'
                        }
                    };