# å‰ç«¯æœåŠ¡å±‚æ‰©å±•æ¶æ„æ–¹æ¡ˆ (å‚è€ƒåç«¯æ¨¡å¼)

## æ¶æ„ç›®å½•ç»“æ„

```
src/services/
â”œâ”€â”€ core/                           # æ ¸å¿ƒæœåŠ¡å±‚
â”‚   â”œâ”€â”€ api-client.js              # HTTPå®¢æˆ·ç«¯å°è£…
â”‚   â”œâ”€â”€ service-registry.js        # æœåŠ¡æ³¨å†Œå’Œä¾èµ–ç®¡ç†
â”‚   â””â”€â”€ error-handler.js           # å…¨å±€é”™è¯¯å¤„ç†æœåŠ¡
â”‚
â”œâ”€â”€ auth/                          # è®¤è¯æœåŠ¡å±‚
â”‚   â”œâ”€â”€ auth-service.js            # è®¤è¯æ ¸å¿ƒæœåŠ¡
â”‚   â””â”€â”€ permission-service.js      # æƒé™ç®¡ç†æœåŠ¡
â”‚
â”œâ”€â”€ user/                          # ç”¨æˆ·æ•°æ®æœåŠ¡å±‚
â”‚   â”œâ”€â”€ user-service.js            # ç”¨æˆ·ä¿¡æ¯æœåŠ¡
â”‚   â”œâ”€â”€ user-settings-service.js   # ç”¨æˆ·è®¾ç½®æœåŠ¡
â”‚   â”œâ”€â”€ user-favorites-service.js  # æ”¶è—ç®¡ç†æœåŠ¡
â”‚   â””â”€â”€ user-history-service.js    # å†å²è®°å½•æœåŠ¡
â”‚
â”œâ”€â”€ search/                        # æœç´¢æœåŠ¡å±‚
â”‚   â”œâ”€â”€ search-service.js          # æœç´¢å¼•æ“æœåŠ¡
â”‚   â”œâ”€â”€ search-sources-service.js  # æœç´¢æºç®¡ç†æœåŠ¡
â”‚   â””â”€â”€ source-checker-service.js  # æœç´¢æºçŠ¶æ€æ£€æŸ¥æœåŠ¡
â”‚
â”œâ”€â”€ community/                     # ç¤¾åŒºæœåŠ¡å±‚
â”‚   â”œâ”€â”€ community-service.js       # ç¤¾åŒºç»Ÿè®¡å’Œæ¦‚è§ˆæœåŠ¡
â”‚   â”œâ”€â”€ community-sources-service.js # ç¤¾åŒºæœç´¢æºæœåŠ¡
â”‚   â””â”€â”€ community-tags-service.js  # ç¤¾åŒºæ ‡ç­¾æœåŠ¡
â”‚
â””â”€â”€ system/                        # ç³»ç»ŸæœåŠ¡å±‚
    â”œâ”€â”€ theme-service.js           # ä¸»é¢˜ç®¡ç†æœåŠ¡
    â”œâ”€â”€ notification-service.js    # é€šçŸ¥æœåŠ¡
    â””â”€â”€ cache-service.js           # ç¼“å­˜ç®¡ç†æœåŠ¡
```

## å„æœåŠ¡æ¨¡å—èŒè´£åˆ’åˆ†

### ğŸ—ï¸ Core æ ¸å¿ƒæœåŠ¡å±‚

#### `api-client.js` - HTTPå®¢æˆ·ç«¯
```javascript
class APIClient {
  // åŸºç¡€HTTPè¯·æ±‚å°è£…
  async request(endpoint, options = {})
  async get(endpoint, params = {})
  async post(endpoint, data = {})
  async put(endpoint, data = {})
  async delete(endpoint)
  
  // è¯·æ±‚æ‹¦æˆªå’Œé‡è¯•
  setupInterceptors()
  setupRetryMechanism()
  
  // Tokenç®¡ç†
  setToken(token)
  clearToken()
}
```

#### `service-registry.js` - æœåŠ¡æ³¨å†Œå™¨
```javascript
class ServiceRegistry {
  // æœåŠ¡æ³¨å†Œå’Œè·å–
  register(name, service)
  get(serviceName)
  
  // ä¾èµ–æ³¨å…¥ç®¡ç†
  injectDependencies(service)
  
  // æœåŠ¡ç”Ÿå‘½å‘¨æœŸ
  initialize()
  destroy()
}
```

#### `error-handler.js` - é”™è¯¯å¤„ç†æœåŠ¡
```javascript
class ErrorHandler {
  // å…¨å±€é”™è¯¯å¤„ç†
  handleAPIError(error)
  handleNetworkError(error)
  
  // é”™è¯¯æ¢å¤æœºåˆ¶
  setupErrorRecovery()
  retryFailedRequest(request)
}
```

### ğŸ” Auth è®¤è¯æœåŠ¡å±‚

#### `auth-service.js` - è®¤è¯æœåŠ¡
```javascript
class AuthService {
  // è®¤è¯æ“ä½œ
  async login(username, password)
  async register(userData)
  async logout()
  
  // Tokenç®¡ç†
  async verifyToken()
  async refreshToken()
  
  // è®¤è¯çŠ¶æ€
  isAuthenticated()
  getCurrentUser()
}
```

#### `permission-service.js` - æƒé™æœåŠ¡
```javascript
class PermissionService {
  // æƒé™æ£€æŸ¥
  hasPermission(permission)
  requireAuth(message)
  
  // ç”¨æˆ·è§’è‰²
  isAdmin()
  isPremiumUser()
  
  // æƒé™éªŒè¯
  validateUserAction(action)
}
```

### ğŸ‘¤ User ç”¨æˆ·æœåŠ¡å±‚

#### `user-service.js` - ç”¨æˆ·ä¿¡æ¯æœåŠ¡
```javascript
class UserService {
  // ç”¨æˆ·ä¿¡æ¯ç®¡ç†
  async getUserProfile()
  async updateProfile(data)
  async changePassword(oldPassword, newPassword)
  async deleteAccount()
  
  // ç”¨æˆ·ç»Ÿè®¡
  async getUserStats()
}
```

#### `user-settings-service.js` - ç”¨æˆ·è®¾ç½®æœåŠ¡
```javascript
class UserSettingsService {
  // è®¾ç½®ç®¡ç†
  async getSettings()
  async updateSettings(settings)
  async resetSettings()
  
  // è®¾ç½®åˆ†ç±»
  async getSearchSettings()
  async getUISettings()
  async getPrivacySettings()
}
```

#### `user-favorites-service.js` - æ”¶è—æœåŠ¡
```javascript
class UserFavoritesService {
  // æ”¶è—ç®¡ç†
  async getFavorites()
  async addFavorite(item)
  async removeFavorite(itemId)
  async syncFavorites()
  
  // æ”¶è—åˆ†ç±»
  async getFavoritesByCategory(category)
  async createCategory(name)
}
```

#### `user-history-service.js` - å†å²è®°å½•æœåŠ¡
```javascript
class UserHistoryService {
  // å†å²è®°å½•
  async getSearchHistory()
  async addToHistory(query)
  async deleteHistoryItem(id)
  async clearAllHistory()
  
  // å†å²ç»Ÿè®¡
  async getSearchStats()
  async getTopQueries()
}
```

### ğŸ” Search æœç´¢æœåŠ¡å±‚

#### `search-service.js` - æœç´¢å¼•æ“æœåŠ¡
```javascript
class SearchService {
  // æœç´¢æ‰§è¡Œ
  async performSearch(keyword, options)
  async buildSearchResults(keyword, options)
  
  // æœç´¢ä¼˜åŒ–
  getSearchSuggestions(query, history)
  async warmupCache(keywords)
  
  // ç»“æœå¤„ç†
  processSearchResults(results)
  sortResultsByRelevance(results)
}
```

#### `search-sources-service.js` - æœç´¢æºç®¡ç†æœåŠ¡
```javascript
class SearchSourcesService {
  // æœç´¢æºç®¡ç†
  async getEnabledSources()
  async addCustomSource(source)
  async updateSource(sourceId, updates)
  async deleteSource(sourceId)
  
  // æœç´¢æºé…ç½®
  async getSourceCategories()
  async importSources(sources)
  async exportSources()
}
```

#### `source-checker-service.js` - çŠ¶æ€æ£€æŸ¥æœåŠ¡
```javascript
class SourceCheckerService {
  // çŠ¶æ€æ£€æŸ¥
  async checkSourceStatus(source, userSettings)
  async checkMultipleSources(sources, userSettings)
  
  // æ£€æŸ¥ç®¡ç†
  async checkAllSourcesStatus()
  async getStatusHistory()
  
  // ç¼“å­˜ç®¡ç†
  clearCache()
  warmupCache(sources)
}
```

### ğŸ˜ï¸ Community ç¤¾åŒºæœåŠ¡å±‚

#### `community-service.js` - ç¤¾åŒºç»Ÿè®¡æœåŠ¡
```javascript
class CommunityService {
  // ç¤¾åŒºç»Ÿè®¡
  async getCommunityStats()
  async getUserCommunityStats()
  
  // ç¤¾åŒºæœç´¢
  async searchCommunityContent(query, options)
  
  // ç¤¾åŒºåŠ¨æ€
  async getRecentActivity()
  async getTrendingContent()
}
```

#### `community-sources-service.js` - ç¤¾åŒºæœç´¢æºæœåŠ¡
```javascript
class CommunitySourcesService {
  // æœç´¢æºåˆ†äº«
  async getCommunitySearchSources(options)
  async shareSourceToCommunity(sourceData)
  async downloadCommunitySource(sourceId)
  
  // æœç´¢æºäº’åŠ¨
  async likeSource(sourceId)
  async reviewSource(sourceId, reviewData)
  async reportSource(sourceId, reportData)
  
  // æœç´¢æºç®¡ç†
  async editCommunitySource(sourceId, updates)
  async deleteCommunitySource(sourceId)
}
```

#### `community-tags-service.js` - ç¤¾åŒºæ ‡ç­¾æœåŠ¡
```javascript
class CommunityTagsService {
  // æ ‡ç­¾ç®¡ç†
  async getAllTags(options)
  async createTag(tagData)
  async updateTag(tagId, updates)
  async deleteTag(tagId)
  
  // æ ‡ç­¾ä½¿ç”¨
  async getPopularTags(category)
  async getTagDetails(tagId)
  
  // æ‰¹é‡æ“ä½œ
  async batchUpdateTagsStatus(tagIds, isActive)
}
```

### âš™ï¸ System ç³»ç»ŸæœåŠ¡å±‚

#### `theme-service.js` - ä¸»é¢˜æœåŠ¡
```javascript
class ThemeService {
  // ä¸»é¢˜ç®¡ç†
  setTheme(theme)
  toggleTheme()
  getCurrentTheme()
  
  // ä¸»é¢˜æ£€æµ‹
  detectSystemTheme()
  applyAutoTheme()
  listenToSystemTheme()
}
```

#### `notification-service.js` - é€šçŸ¥æœåŠ¡
```javascript
class NotificationService {
  // é€šçŸ¥æ˜¾ç¤º
  showToast(message, type, duration)
  showModal(title, content, options)
  
  // é€šçŸ¥ç®¡ç†
  addNotification(notification)
  removeNotification(id)
  clearAllNotifications()
  
  // é€šçŸ¥è®¾ç½®
  setNotificationSettings(settings)
}
```

#### `cache-service.js` - ç¼“å­˜æœåŠ¡
```javascript
class CacheService {
  // ç¼“å­˜æ“ä½œ
  set(key, value, ttl)
  get(key)
  delete(key)
  clear()
  
  // ç¼“å­˜ç­–ç•¥
  setupCachePolicy(policy)
  cleanupExpiredCache()
  
  // ç¼“å­˜ç»Ÿè®¡
  getCacheStats()
  getCacheSize()
}
```

## æœåŠ¡é—´ä¾èµ–å…³ç³»

```
AuthService â† UserService, UserSettingsService, UserFavoritesService, UserHistoryService
APIClient â† æ‰€æœ‰éœ€è¦HTTPè¯·æ±‚çš„æœåŠ¡
CacheService â† SearchService, CommunityService
ThemeService â†’ NotificationService
ServiceRegistry â†’ æ‰€æœ‰æœåŠ¡ (ä¾èµ–æ³¨å…¥)
```

## è¿ç§»æ˜ å°„

### ä»ç°æœ‰æ–‡ä»¶åˆ°æ–°æ¶æ„ï¼š

**api.js** æ‹†åˆ†ä¸ºï¼š
- `core/api-client.js` (HTTPå®¢æˆ·ç«¯)
- `core/error-handler.js` (é”™è¯¯å¤„ç†)
- `user/user-service.js` (ç”¨æˆ·ç›¸å…³API)
- `user/user-settings-service.js` (è®¾ç½®API)
- `user/user-favorites-service.js` (æ”¶è—API)
- `user/user-history-service.js` (å†å²API)

**auth.js** æ‹†åˆ†ä¸ºï¼š
- `auth/auth-service.js` (è®¤è¯æ ¸å¿ƒ)
- `auth/permission-service.js` (æƒé™ç®¡ç†)

**search.js** æ‹†åˆ†ä¸ºï¼š
- `search/search-service.js` (æœç´¢å¼•æ“)
- `search/search-sources-service.js` (æœç´¢æºç®¡ç†)

**enhanced-source-checker.js** é‡æ„ä¸ºï¼š
- `search/source-checker-service.js`

**community-sources-api.js** é‡æ„ä¸ºï¼š
- `community/community-sources-service.js`

**community-tags-api.js** é‡æ„ä¸ºï¼š
- `community/community-tags-service.js`

**theme.js** é‡æ„ä¸ºï¼š
- `system/theme-service.js`

**æ–°å¢æœåŠ¡**ï¼š
- `core/service-registry.js` (æœåŠ¡ç®¡ç†)
- `community/community-service.js` (ç¤¾åŒºç»Ÿè®¡)
- `system/notification-service.js` (é€šçŸ¥ç³»ç»Ÿ)
- `system/cache-service.js` (ç¼“å­˜ç®¡ç†)

## ä¼˜åŠ¿

1. **æ¨¡å—åŒ–**: æ¯ä¸ªæœåŠ¡èŒè´£å•ä¸€ï¼Œä¾¿äºç»´æŠ¤
2. **å¯æ‰©å±•**: æ–°åŠŸèƒ½å¯ä»¥ç‹¬ç«‹æ·»åŠ æ–°æœåŠ¡
3. **ä¾èµ–æ¸…æ™°**: æœåŠ¡é—´ä¾èµ–å…³ç³»æ˜ç¡®
4. **æµ‹è¯•å‹å¥½**: æ¯ä¸ªæœåŠ¡å¯ä»¥ç‹¬ç«‹æµ‹è¯•
5. **å›¢é˜Ÿåä½œ**: ä¸åŒå¼€å‘è€…å¯ä»¥å¹¶è¡Œå¼€å‘ä¸åŒæ¨¡å—